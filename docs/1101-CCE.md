## Common Correlated Effects Models

### Econometric model

ARDL(1, 1) model with heterogeneous coefficients and common correlated effects (CCE) is given by:

$$
\begin{equation}
\begin{split}
y(i,t) &= b0(i) + b1(i) * y(i,t-1) + b2(i) * x(i,t) + b3(i) * x(i,t-1) \\
&\phantom{=}\quad            + u(i,t)
\end{split}\label{eq:cce-dynamic}
\end{equation}
$$

where

$$
u(i,t) = g(i) * f(t) + e(i,t)
$$

- `f(t)` is an unobserved common factor loading, 
- `g(i)` a heterogeneous factor loading, 
- `x(i,t)` is a (1 x K) vector and `b2(i)` and `b3(i)` the coefficient vectors. It is assumed that `x(i,t)` is strictly exogenous.
- The error `e(i,t)` is iid. 
- The **heterogeneous** coefficients `b1(i)`, `b2(i)` and `b3(i)` are randomly distributed around a common mean. 
  - In the case of a static panel model, we have `b1(i) = 0`.


### Estimation

Pesaran (2006) shows that the averages of the coefficients `b0`, `b2` and `b3` (for example for b2(mg) = 1/N sum(b2(i))) can be consistently estimated by adding cross sectional means of the dependent and all independent variables. 

$$
\begin{equation}
y(i,t) = b0(i) + x(i,t)*b2(i) + d(i)*z(i,t) + e(i,t). \label{eq:pesaran2006}
\end{equation}
$$

Eq. \@ref(eq:pesaran2006) is the default equation in `xtdcce2`.

--------------------------------------------------------------------------------

Chudik and Pesaran (2015) extends to a dynamic panel data model (`b1(i) != 0`); `pT` lags of the cross sectional means are added to achieve consistency.

- The mean group estimates for `b1`, `b2` and `b3` are consistently estimated as long as `N`, `T` and `pT` go to infinity. This implies that *the number of cross sectional units* and *time periods* is assumed to **grow with the same rate**.
  
  In an empirical setting this can be interpreted as `N/T` being constant. 

- A dataset with one dimension being large in comparison to the other would lead to inconsistent estimates, even if both dimension are large in numbers. 

The variance of the mean group coefficient `b1(mg)` is estimated as:

$$
\var(b1(mg)) = \frac{1}{N} \sum_{i=1}^N \left(b1(i) - b1(mg)\right)^2
$$


If the vector $pi(mg) = \left(b0(mg), b1(mg)\right)',$ the variance is given by:

$$
\var(pi(mg)) =  \frac{1}{N} \sum_{i=1}^N \left(pi(i) - pi(mg)\right) \; \left(p(i)-pi(mg)\right)'
$$

ref:

- [Estimating Dynamic Common Correlated Effects Models in Stata, `xtdcce2`](https://janditzen.github.io/xtdcce2/#4-econometric-and-empirical-model)
