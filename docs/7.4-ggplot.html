<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7.4 ggplot | R Notes</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="7.4 ggplot | R Notes" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="my1396/R-Notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7.4 ggplot | R Notes" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Menghan Yuan" />


<meta name="date" content="2025-07-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="images/r-project-favicon.ico" type="image/x-icon" />
<link rel="prev" href="7.3-control-graphics-devices.html"/>
<link rel="next" href="7.5-plot-raster-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<head>
    <!-- MathJax config: define new macros -->
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [['$','$'], ['\\(','\\)']],
            processEscapes: true
          },
          TeX: { 
            inlineMath: [   // start/end delimiter pairs for in-line math
              ['$', '$'],
              ['\\(', '\\)']
            ],
            displayMath: [  // start/end delimiter pairs for display math
              ['$$', '$$'],
              ['\\[', '\\]']
            ],
            processEscapes: true, // use \$ to produce a literal dollar sign
            tags: 'ams',  // should be 'ams', 'none', or 'all'
            Macros: {
              vect: ["\\mathbf{#1}", 1],
              mat: ["\\mathbf{#1}", 1], 

              bA: "\\boldsymbol{A}",
              bB: "\\boldsymbol{B}",
              bC: "\\boldsymbol{C}",
              bD: "\\boldsymbol{D}",
              bE: "\\boldsymbol{E}",
              bF: "\\boldsymbol{F}",
              bG: "\\boldsymbol{G}",
              bH: "\\boldsymbol{H}",
              bI: "\\boldsymbol{I}",
              bJ: "\\boldsymbol{J}",
              bK: "\\boldsymbol{K}",
              bL: "\\boldsymbol{L}",
              bM: "\\boldsymbol{M}",
              bN: "\\boldsymbol{N}",
              bP: "\\boldsymbol{P}",
              bQ: "\\boldsymbol{Q}",
              bR: "\\boldsymbol{R}",
              bS: "\\boldsymbol{S}",
              bT: "\\boldsymbol{T}",
              bU: "\\boldsymbol{U}",
              bV: "\\boldsymbol{V}",
              bW: "\\boldsymbol{W}",
              bX: "\\boldsymbol{X}",
              bY: "\\boldsymbol{Y}",
              bZ: "\\boldsymbol{Z}",
              ba: "\\boldsymbol{a}",
              bb: "\\boldsymbol{b}",
              bc: "\\boldsymbol{c}",
              bd: "\\boldsymbol{d}",
              be: "\\boldsymbol{e}",
              bg: "\\boldsymbol{g}",
              bh: "\\boldsymbol{h}",
              bi: "\\boldsymbol{\\imath}",
              bm: "\\boldsymbol{m}",
              bp: "\\boldsymbol{p}",
              bq: "\\boldsymbol{q}",
              br: "\\boldsymbol{r}",
              bs: "\\boldsymbol{s}",
              bt: "\\boldsymbol{t}",
              bu: "\\boldsymbol{u}",
              bv: "\\boldsymbol{v}",
              bw: "\\boldsymbol{w}",
              bx: "\\boldsymbol{x}",
              by: "\\boldsymbol{y}",

              Acal: "\\mathcal{A}",
              Bcal: "\\mathcal{B}",
              Ccal: "\\mathcal{C}",
              Dcal: "\\mathcal{D}",
              Ecal: "\\mathcal{E}",
              Fcal: "\\mathcal{F}",
              Gcal: "\\mathcal{G}",
              Hcal: "\\mathcal{H}",
              Ical: "\\mathcal{I}",
              Jcal: "\\mathcal{J}",
              Kcal: "\\mathcal{K}",
              Lcal: "\\mathcal{L}",
              Mcal: "\\mathcal{M}",
              Ncal: "\\mathcal{N}",
              Ocal: "\\mathcal{O}",
              Pcal: "\\mathcal{P}",
              Qcal: "\\mathcal{Q}",
              Rcal: "\\mathcal{R}",
              Scal: "\\mathcal{S}",
              Tcal: "\\mathcal{T}",
              Ucal: "\\mathcal{U}",
              Vcal: "\\mathcal{V}",
              Wcal: "\\mathcal{W}",
              Xcal: "\\mathcal{X}",
              Ycal: "\\mathcal{Y}",
              Zcal: "\\mathcal{Z}",

              A: "\\mathbb{A}",
              B: "\\mathbb{B}",
              C: "\\mathbb{C}",
              D: "\\mathbb{D}",
              E: "\\mathbb{E}",
              F: "\\mathbb{F}",
              G: "\\mathbb{G}",
              H: "\\mathbb{H}",
              I: "\\mathbb{I}",
              J: "\\mathbb{J}",
              K: "\\mathbb{K}",
              L: "\\mathbb{L}",
              M: "\\mathbb{M}",
              N: "\\mathbb{N}",
              O: "\\mathbb{O}",
              P: "\\mathbb{P}",
              Q: "\\mathbb{Q}",
              R: "\\mathbb{R}",
              S: "\\mathbb{S}",
              T: "\\mathbb{T}",
              U: "\\mathbb{U}",
              V: "\\mathbb{V}",
              W: "\\mathbb{W}",
              X: "\\mathbb{X}",
              Y: "\\mathbb{Y}",
              Z: "\\mathbb{Z}",

              bAlpha: "\\boldsymbol{\\Alpha}",
              bBeta: "\\boldsymbol{\\beta}",
              bDelta: "\\boldsymbol{\\delta}",
              bEta: "\\boldsymbol{\\eta}",
              bGamma: "\\boldsymbol{\\Gamma}",
              bLambda: "\\boldsymbol{\\Lambda}",
              bOmega: "\\boldsymbol{\\Omega}",
              bPhi: "\\boldsymbol{\\Phi}",
              bPi: "\\boldsymbol{\\Pi}",
              bPsi: "\\boldsymbol{\\Psi}",
              bSigma: "\\boldsymbol{\\Sigma}",
              bTau: "\\boldsymbol{\\tau}",
              bXi: "\\boldsymbol{\\Xi}",
              bbeta: "\\boldsymbol{\\beta}",
              bdelta: "\\boldsymbol{\\delta}",
              blambda: "\\boldsymbol{\\lambda}",
              bmu: "\\boldsymbol{\\mu}",
              bphi: "\\boldsymbol{\\phi}",
              bpi: "\\boldsymbol{\\pi}",
              bpsi: "\\boldsymbol{\\psi}",
              brho: "\\boldsymbol{\\rho}",
              bsigma: "\\boldsymbol{\\sigma}",
              btau: "\\boldsymbol{\\tau}",
              bxi: "\\boldsymbol{\\xi}",
              bEta: "\\boldsymbol{\\eta}",
              bPhi: "\\boldsymbol{\\Phi}",
              bPi: "\\boldsymbol{\\Pi}",
              bPsi: "\\boldsymbol{\\Psi}",
              bXi: "\\boldsymbol{\\Xi}",
              blambda: "\\boldsymbol{\\lambda}",
              bmu: "\\boldsymbol{\\mu}",
              bphi: "\\boldsymbol{\\phi}",
              bpi: "\\boldsymbol{\\pi}",
              bpsi: "\\boldsymbol{\\psi}",
              brho: "\\boldsymbol{\\rho}",
              bsigma: "\\boldsymbol{\\sigma}",
                        
              curl: ["\\left\\lbrace#1\\right\\rbrace", 1],
              floor: ["\\left\\lfloor#1\\right\\rfloor", 1],
              ceil: ["\\left\\lceil#1\\right\\rceil", 1],
              abs: ["\\left\\lvert#1\\right\\rvert", 1],
              norm: ["\\left\\lVert#1\\right\\rVert", 1],

              independent: "\\mathrel{\\perp\\!\\!\\perp}",

              var: "\\mathrm{var}",
              diag: "\\mathrm{diag}",
              rank: "\\mathrm{rank}",
              vecc: "\\mathrm{vec}",
            }
          }
        });
    </script>

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Code+Pro">
</head>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a>
<ul>
<li class="chapter" data-level="1.1" data-path="1.1-usage.html"><a href="1.1-usage.html"><i class="fa fa-check"></i><b>1.1</b> Usage</a></li>
<li class="chapter" data-level="1.2" data-path="1.2-render-book.html"><a href="1.2-render-book.html"><i class="fa fa-check"></i><b>1.2</b> Render book</a></li>
<li class="chapter" data-level="1.3" data-path="1.3-preview-book.html"><a href="1.3-preview-book.html"><i class="fa fa-check"></i><b>1.3</b> Preview book</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-rstudio.html"><a href="2-rstudio.html"><i class="fa fa-check"></i><b>2</b> Rstudio</a>
<ul>
<li class="chapter" data-level="2.1" data-path="2.1-dark-theme.html"><a href="2.1-dark-theme.html"><i class="fa fa-check"></i><b>2.1</b> Dark Theme</a></li>
<li class="chapter" data-level="2.2" data-path="2.2-update-r.html"><a href="2.2-update-r.html"><i class="fa fa-check"></i><b>2.2</b> Update R</a></li>
<li class="chapter" data-level="2.3" data-path="2.3-packages-management.html"><a href="2.3-packages-management.html"><i class="fa fa-check"></i><b>2.3</b> Packages Management</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="2.3-packages-management.html"><a href="2.3-packages-management.html#load-packages"><i class="fa fa-check"></i><b>2.3.1</b> Load packages</a></li>
<li class="chapter" data-level="2.3.2" data-path="2.3-packages-management.html"><a href="2.3-packages-management.html#install-packages"><i class="fa fa-check"></i><b>2.3.2</b> Install packages</a></li>
<li class="chapter" data-level="2.3.3" data-path="2.3-packages-management.html"><a href="2.3-packages-management.html#update-packages"><i class="fa fa-check"></i><b>2.3.3</b> Update packages</a></li>
<li class="chapter" data-level="2.3.4" data-path="2.3-packages-management.html"><a href="2.3-packages-management.html#put-your-r-package-on-github"><i class="fa fa-check"></i><b>2.3.4</b> Put your R package on GitHub</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2.4-using-git-with-rstudio.html"><a href="2.4-using-git-with-rstudio.html"><i class="fa fa-check"></i><b>2.4</b> Using Git with RStudio</a></li>
<li class="chapter" data-level="2.5" data-path="2.5-github-copilot.html"><a href="2.5-github-copilot.html"><i class="fa fa-check"></i><b>2.5</b> GitHub Copilot</a></li>
<li class="chapter" data-level="2.6" data-path="2.6-save-r-workspace.html"><a href="2.6-save-r-workspace.html"><i class="fa fa-check"></i><b>2.6</b> Save R Workspace</a></li>
<li class="chapter" data-level="2.7" data-path="2.7-pane-layout.html"><a href="2.7-pane-layout.html"><i class="fa fa-check"></i><b>2.7</b> Pane Layout</a></li>
<li class="chapter" data-level="2.8" data-path="2.8-options.html"><a href="2.8-options.html"><i class="fa fa-check"></i><b>2.8</b> Options</a></li>
<li class="chapter" data-level="2.9" data-path="2.9-r-startup.html"><a href="2.9-r-startup.html"><i class="fa fa-check"></i><b>2.9</b> R Startup</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="2.9-r-startup.html"><a href="2.9-r-startup.html#rprofile"><i class="fa fa-check"></i><b>2.9.1</b> <code>.Rprofile</code></a></li>
<li class="chapter" data-level="2.9.2" data-path="2.9-r-startup.html"><a href="2.9-r-startup.html#renviron"><i class="fa fa-check"></i><b>2.9.2</b> <code>.Renviron</code></a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="2.10-vs-code.html"><a href="2.10-vs-code.html"><i class="fa fa-check"></i><b>2.10</b> VS Code</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="2.10-vs-code.html"><a href="2.10-vs-code.html#radian"><i class="fa fa-check"></i><b>2.10.1</b> Radian</a></li>
<li class="chapter" data-level="2.10.2" data-path="2.10-vs-code.html"><a href="2.10-vs-code.html#faq-1"><i class="fa fa-check"></i><b>2.10.2</b> FAQ</a></li>
<li class="chapter" data-level="" data-path="2.10-vs-code.html"><a href="2.10-vs-code.html#plot-viewer"><i class="fa fa-check"></i>Plot Viewer</a></li>
<li class="chapter" data-level="" data-path="2.10-vs-code.html"><a href="2.10-vs-code.html#rmd"><i class="fa fa-check"></i>Rmd</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-rmd-1.html"><a href="3-rmd-1.html"><i class="fa fa-check"></i><b>3</b> Rmd</a>
<ul>
<li class="chapter" data-level="3.1" data-path="3.1-yaml-metadata.html"><a href="3.1-yaml-metadata.html"><i class="fa fa-check"></i><b>3.1</b> YAML metadata</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="3.1-yaml-metadata.html"><a href="3.1-yaml-metadata.html#top-level-yaml-metadata"><i class="fa fa-check"></i><b>3.1.1</b> Top-level YAML metadata</a></li>
<li class="chapter" data-level="3.1.2" data-path="3.1-yaml-metadata.html"><a href="3.1-yaml-metadata.html#mathjax-options"><i class="fa fa-check"></i><b>3.1.2</b> MathJax Options</a></li>
<li class="chapter" data-level="3.1.3" data-path="3.1-yaml-metadata.html"><a href="3.1-yaml-metadata.html#document-dependency"><i class="fa fa-check"></i><b>3.1.3</b> Document dependency</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="3.2-render-rmd.html"><a href="3.2-render-rmd.html"><i class="fa fa-check"></i><b>3.2</b> Render Rmd</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="3.2-render-rmd.html"><a href="3.2-render-rmd.html#render-a-single-document"><i class="fa fa-check"></i><b>3.2.1</b> Render a single document</a></li>
<li class="chapter" data-level="3.2.2" data-path="3.2-render-rmd.html"><a href="3.2-render-rmd.html#render-multiple-documents-as-a-website"><i class="fa fa-check"></i><b>3.2.2</b> Render multiple documents as a website</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="3.3-chunk-options.html"><a href="3.3-chunk-options.html"><i class="fa fa-check"></i><b>3.3</b> Chunk Options</a>
<ul>
<li class="chapter" data-level="" data-path="3.3-chunk-options.html"><a href="3.3-chunk-options.html#hooks"><i class="fa fa-check"></i>Hooks</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="3.4-print-verbatim-r-code-chunks.html"><a href="3.4-print-verbatim-r-code-chunks.html"><i class="fa fa-check"></i><b>3.4</b> Print Verbatim R code chunks</a></li>
<li class="chapter" data-level="3.5" data-path="3.5-rmd-basics.html"><a href="3.5-rmd-basics.html"><i class="fa fa-check"></i><b>3.5</b> Rmd Basics</a></li>
<li class="chapter" data-level="3.6" data-path="3.6-citations.html"><a href="3.6-citations.html"><i class="fa fa-check"></i><b>3.6</b> Citations</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="3.6-citations.html"><a href="3.6-citations.html#bibliographies"><i class="fa fa-check"></i><b>3.6.1</b> Bibliographies</a></li>
<li class="chapter" data-level="3.6.2" data-path="3.6-citations.html"><a href="3.6-citations.html#bibliography-placement"><i class="fa fa-check"></i><b>3.6.2</b> Bibliography placement</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="3.7-cross-references.html"><a href="3.7-cross-references.html"><i class="fa fa-check"></i><b>3.7</b> Cross References</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="3.7-cross-references.html"><a href="3.7-cross-references.html#using-bookdown"><i class="fa fa-check"></i><b>3.7.1</b> Using <code>bookdown</code></a></li>
<li class="chapter" data-level="3.7.2" data-path="3.7-cross-references.html"><a href="3.7-cross-references.html#using-the-latex-way"><i class="fa fa-check"></i><b>3.7.2</b> Using the LaTeX Way</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="3.8-equations-1.html"><a href="3.8-equations-1.html"><i class="fa fa-check"></i><b>3.8</b> Equations</a></li>
<li class="chapter" data-level="3.9" data-path="3.9-theorems-1.html"><a href="3.9-theorems-1.html"><i class="fa fa-check"></i><b>3.9</b> Theorems</a></li>
<li class="chapter" data-level="3.10" data-path="3.10-figures-1.html"><a href="3.10-figures-1.html"><i class="fa fa-check"></i><b>3.10</b> Figures</a>
<ul>
<li class="chapter" data-level="" data-path="3.10-figures-1.html"><a href="3.10-figures-1.html#latex-symbols-in-fig.-caption"><i class="fa fa-check"></i>Latex symbols in Fig. caption</a></li>
<li class="chapter" data-level="" data-path="3.10-figures-1.html"><a href="3.10-figures-1.html#refer-to-another-figure-in-figure-caption"><i class="fa fa-check"></i>Refer to another figure in figure caption</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="3.11-tables-1.html"><a href="3.11-tables-1.html"><i class="fa fa-check"></i><b>3.11</b> Tables</a>
<ul>
<li class="chapter" data-level="3.11.1" data-path="3.11-tables-1.html"><a href="3.11-tables-1.html#knitrkable"><i class="fa fa-check"></i><b>3.11.1</b> <code>knitr::kable</code></a></li>
<li class="chapter" data-level="3.11.2" data-path="3.11-tables-1.html"><a href="3.11-tables-1.html#data-frame-printing"><i class="fa fa-check"></i><b>3.11.2</b> Data frame printing</a></li>
<li class="chapter" data-level="3.11.3" data-path="3.11-tables-1.html"><a href="3.11-tables-1.html#stargazer"><i class="fa fa-check"></i><b>3.11.3</b> Stargazer</a></li>
<li class="chapter" data-level="3.11.4" data-path="3.11-tables-1.html"><a href="3.11-tables-1.html#xtable"><i class="fa fa-check"></i><b>3.11.4</b> <code>xtable</code></a></li>
<li class="chapter" data-level="3.11.5" data-path="3.11-tables-1.html"><a href="3.11-tables-1.html#kableextra"><i class="fa fa-check"></i><b>3.11.5</b> <code>kableExtra</code></a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="3.12-rmd-github-pages.html"><a href="3.12-rmd-github-pages.html"><i class="fa fa-check"></i><b>3.12</b> Rmd GitHub Pages</a>
<ul>
<li class="chapter" data-level="" data-path="3.12-rmd-github-pages.html"><a href="3.12-rmd-github-pages.html#project-structure"><i class="fa fa-check"></i>Project structure</a></li>
<li class="chapter" data-level="" data-path="3.12-rmd-github-pages.html"><a href="3.12-rmd-github-pages.html#site.yml-config"><i class="fa fa-check"></i><code>_site.yml</code> config</a></li>
<li class="chapter" data-level="" data-path="3.12-rmd-github-pages.html"><a href="3.12-rmd-github-pages.html#index.rmd"><i class="fa fa-check"></i><code>index.Rmd</code></a></li>
<li class="chapter" data-level="" data-path="3.12-rmd-github-pages.html"><a href="3.12-rmd-github-pages.html#r-scripts"><i class="fa fa-check"></i>R scripts</a></li>
<li class="chapter" data-level="" data-path="3.12-rmd-github-pages.html"><a href="3.12-rmd-github-pages.html#workflow"><i class="fa fa-check"></i>Workflow</a></li>
<li class="chapter" data-level="" data-path="3.12-rmd-github-pages.html"><a href="3.12-rmd-github-pages.html#css-style"><i class="fa fa-check"></i>CSS Style</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-bookdown.html"><a href="4-bookdown.html"><i class="fa fa-check"></i><b>4</b> bookdown</a>
<ul>
<li class="chapter" data-level="4.1" data-path="4.1-bookdown-project-structure.html"><a href="4.1-bookdown-project-structure.html"><i class="fa fa-check"></i><b>4.1</b> bookdown project structure</a>
<ul>
<li class="chapter" data-level="" data-path="4.1-bookdown-project-structure.html"><a href="4.1-bookdown-project-structure.html#output.yml"><i class="fa fa-check"></i><code>_output.yml</code></a></li>
<li class="chapter" data-level="" data-path="4.1-bookdown-project-structure.html"><a href="4.1-bookdown-project-structure.html#bookdown.yml"><i class="fa fa-check"></i><code>_bookdown.yml</code></a></li>
<li class="chapter" data-level="" data-path="4.1-bookdown-project-structure.html"><a href="4.1-bookdown-project-structure.html#index.rmd-1"><i class="fa fa-check"></i><code>index.Rmd</code></a></li>
<li class="chapter" data-level="" data-path="4.1-bookdown-project-structure.html"><a href="4.1-bookdown-project-structure.html#rmd-files"><i class="fa fa-check"></i><code>.Rmd</code> files</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="4.2-rendering-bookdown.html"><a href="4.2-rendering-bookdown.html"><i class="fa fa-check"></i><b>4.2</b> Rendering bookdown</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="4.2-rendering-bookdown.html"><a href="4.2-rendering-bookdown.html#rendering-bookdown-website"><i class="fa fa-check"></i><b>4.2.1</b> Rendering bookdown website</a></li>
<li class="chapter" data-level="4.2.2" data-path="4.2-rendering-bookdown.html"><a href="4.2-rendering-bookdown.html#rendering-bookdown-book"><i class="fa fa-check"></i><b>4.2.2</b> Rendering bookdown book</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="4.3-toggle-visibility-of-solutions.html"><a href="4.3-toggle-visibility-of-solutions.html"><i class="fa fa-check"></i><b>4.3</b> Toggle Visibility of Solutions</a></li>
<li class="chapter" data-level="4.4" data-path="4.4-quarto.html"><a href="4.4-quarto.html"><i class="fa fa-check"></i><b>4.4</b> Quarto</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="4.4-quarto.html"><a href="4.4-quarto.html#book-structure"><i class="fa fa-check"></i><b>4.4.1</b> Book Structure</a></li>
<li class="chapter" data-level="4.4.2" data-path="4.4-quarto.html"><a href="4.4-quarto.html#html-theming"><i class="fa fa-check"></i><b>4.4.2</b> HTML Theming</a></li>
<li class="chapter" data-level="4.4.3" data-path="4.4-quarto.html"><a href="4.4-quarto.html#render-quarto"><i class="fa fa-check"></i><b>4.4.3</b> Render Quarto</a></li>
<li class="chapter" data-level="4.4.4" data-path="4.4-quarto.html"><a href="4.4-quarto.html#cross-references-1"><i class="fa fa-check"></i><b>4.4.4</b> Cross References</a></li>
<li class="chapter" data-level="4.4.5" data-path="4.4-quarto.html"><a href="4.4-quarto.html#equations-3"><i class="fa fa-check"></i><b>4.4.5</b> Equations</a></li>
<li class="chapter" data-level="4.4.6" data-path="4.4-quarto.html"><a href="4.4-quarto.html#divs-and-spans"><i class="fa fa-check"></i><b>4.4.6</b> Divs and Spans</a></li>
<li class="chapter" data-level="4.4.7" data-path="4.4-quarto.html"><a href="4.4-quarto.html#theorems-2"><i class="fa fa-check"></i><b>4.4.7</b> Theorems</a></li>
<li class="chapter" data-level="4.4.8" data-path="4.4-quarto.html"><a href="4.4-quarto.html#callouts"><i class="fa fa-check"></i><b>4.4.8</b> Callouts</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-basic-r.html"><a href="5-basic-r.html"><i class="fa fa-check"></i><b>5</b> Basic R</a>
<ul>
<li class="chapter" data-level="5.1" data-path="5.1-data-input-output.html"><a href="5.1-data-input-output.html"><i class="fa fa-check"></i><b>5.1</b> Data Input &amp; Output</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="5.1-data-input-output.html"><a href="5.1-data-input-output.html#read-data"><i class="fa fa-check"></i><b>5.1.1</b> Read Data</a></li>
<li class="chapter" data-level="5.1.2" data-path="5.1-data-input-output.html"><a href="5.1-data-input-output.html#write-data"><i class="fa fa-check"></i><b>5.1.2</b> Write Data</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="5.2-functions.html"><a href="5.2-functions.html"><i class="fa fa-check"></i><b>5.2</b> Functions</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="5.2-functions.html"><a href="5.2-functions.html#inspecting-object-types-and-structure"><i class="fa fa-check"></i><b>5.2.1</b> Inspecting Object Types and Structure</a></li>
<li class="chapter" data-level="5.2.2" data-path="5.2-functions.html"><a href="5.2-functions.html#type-of-variables"><i class="fa fa-check"></i><b>5.2.2</b> Type of Variables</a></li>
<li class="chapter" data-level="5.2.3" data-path="5.2-functions.html"><a href="5.2-functions.html#variable-scope"><i class="fa fa-check"></i><b>5.2.3</b> Variable Scope</a></li>
<li class="chapter" data-level="5.2.4" data-path="5.2-functions.html"><a href="5.2-functions.html#control-structures"><i class="fa fa-check"></i><b>5.2.4</b> Control Structures</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="5.3-basic-r-functions.html"><a href="5.3-basic-r-functions.html"><i class="fa fa-check"></i><b>5.3</b> Basic R functions</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="5.3-basic-r-functions.html"><a href="5.3-basic-r-functions.html#workspace-management"><i class="fa fa-check"></i><b>5.3.1</b> Workspace Management</a></li>
<li class="chapter" data-level="5.3.2" data-path="5.3-basic-r-functions.html"><a href="5.3-basic-r-functions.html#data-display-and-output"><i class="fa fa-check"></i><b>5.3.2</b> Data Display and Output</a></li>
<li class="chapter" data-level="5.3.3" data-path="5.3-basic-r-functions.html"><a href="5.3-basic-r-functions.html#data-manipulation-and-transformation"><i class="fa fa-check"></i><b>5.3.3</b> Data Manipulation and Transformation</a></li>
<li class="chapter" data-level="5.3.4" data-path="5.3-basic-r-functions.html"><a href="5.3-basic-r-functions.html#generate-random-seeds"><i class="fa fa-check"></i><b>5.3.4</b> Generate Random Seeds</a></li>
<li class="chapter" data-level="5.3.5" data-path="5.3-basic-r-functions.html"><a href="5.3-basic-r-functions.html#draw-random-samples"><i class="fa fa-check"></i><b>5.3.5</b> Draw random samples</a></li>
<li class="chapter" data-level="5.3.6" data-path="5.3-basic-r-functions.html"><a href="5.3-basic-r-functions.html#fit-a-distribution"><i class="fa fa-check"></i><b>5.3.6</b> Fit a distribution</a></li>
<li class="chapter" data-level="5.3.7" data-path="5.3-basic-r-functions.html"><a href="5.3-basic-r-functions.html#operation-on-list"><i class="fa fa-check"></i><b>5.3.7</b> Operation on list</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="5.4-data-splitting-and-grouping.html"><a href="5.4-data-splitting-and-grouping.html"><i class="fa fa-check"></i><b>5.4</b> Data Splitting and Grouping</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="5.4-data-splitting-and-grouping.html"><a href="5.4-data-splitting-and-grouping.html#the-split-function"><i class="fa fa-check"></i><b>5.4.1</b> The <code>split()</code> Function</a></li>
<li class="chapter" data-level="5.4.2" data-path="5.4-data-splitting-and-grouping.html"><a href="5.4-data-splitting-and-grouping.html#split-and-apply-operations"><i class="fa fa-check"></i><b>5.4.2</b> Split-and-Apply Operations</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="5.5-apply-family.html"><a href="5.5-apply-family.html"><i class="fa fa-check"></i><b>5.5</b> <code>*apply()</code> Family</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="5.5-apply-family.html"><a href="5.5-apply-family.html#parallel-version-of-apply-function"><i class="fa fa-check"></i><b>5.5.1</b> <span style="color:#008B45">Parallel</span> version of <code>apply</code> function</a></li>
<li class="chapter" data-level="5.5.2" data-path="5.5-apply-family.html"><a href="5.5-apply-family.html#related-functions"><i class="fa fa-check"></i><b>5.5.2</b> Related Functions</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="5.6-statistical-summary-functions.html"><a href="5.6-statistical-summary-functions.html"><i class="fa fa-check"></i><b>5.6</b> Statistical Summary Functions</a></li>
<li class="chapter" data-level="5.7" data-path="5.7-contingency-table.html"><a href="5.7-contingency-table.html"><i class="fa fa-check"></i><b>5.7</b> Contingency Table</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="5.7-contingency-table.html"><a href="5.7-contingency-table.html#basic-frequency-counting"><i class="fa fa-check"></i><b>5.7.1</b> Basic Frequency Counting</a></li>
<li class="chapter" data-level="5.7.2" data-path="5.7-contingency-table.html"><a href="5.7-contingency-table.html#creating-contingency-tables"><i class="fa fa-check"></i><b>5.7.2</b> Creating Contingency Tables</a></li>
<li class="chapter" data-level="5.7.3" data-path="5.7-contingency-table.html"><a href="5.7-contingency-table.html#working-with-arrays-and-multi-dimensional-tables"><i class="fa fa-check"></i><b>5.7.3</b> Working with Arrays and Multi-dimensional Tables</a></li>
<li class="chapter" data-level="5.7.4" data-path="5.7-contingency-table.html"><a href="5.7-contingency-table.html#flattening-and-exporting-tables"><i class="fa fa-check"></i><b>5.7.4</b> Flattening and Exporting Tables</a></li>
<li class="chapter" data-level="5.7.5" data-path="5.7-contingency-table.html"><a href="5.7-contingency-table.html#table-visualization-and-formatting"><i class="fa fa-check"></i><b>5.7.5</b> Table Visualization and Formatting</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="5.8-data-frame-operations.html"><a href="5.8-data-frame-operations.html"><i class="fa fa-check"></i><b>5.8</b> Data Frame Operations</a>
<ul>
<li class="chapter" data-level="" data-path="5.8-data-frame-operations.html"><a href="5.8-data-frame-operations.html#columnrow-wise-operations"><i class="fa fa-check"></i>Column/Row-wise Operations</a></li>
<li class="chapter" data-level="5.8.1" data-path="5.8-data-frame-operations.html"><a href="5.8-data-frame-operations.html#process-na-values"><i class="fa fa-check"></i><b>5.8.1</b> <span style="color:#008B45"><strong>Process <code>NA</code> values</strong></span></a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="5.9-matrix-multiplication.html"><a href="5.9-matrix-multiplication.html"><i class="fa fa-check"></i><b>5.9</b> Matrix multiplication</a></li>
<li class="chapter" data-level="5.10" data-path="5.10-string-operations.html"><a href="5.10-string-operations.html"><i class="fa fa-check"></i><b>5.10</b> String Operations</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-tidyverse.html"><a href="6-tidyverse.html"><i class="fa fa-check"></i><b>6</b> Tidyverse</a>
<ul>
<li class="chapter" data-level="6.1" data-path="6.1-basic-operations-on-tibbles.html"><a href="6.1-basic-operations-on-tibbles.html"><i class="fa fa-check"></i><b>6.1</b> Basic operations on tibbles</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="6.1-basic-operations-on-tibbles.html"><a href="6.1-basic-operations-on-tibbles.html#check-unique-values"><i class="fa fa-check"></i><b>6.1.1</b> Check Unique Values</a></li>
<li class="chapter" data-level="6.1.2" data-path="6.1-basic-operations-on-tibbles.html"><a href="6.1-basic-operations-on-tibbles.html#column-names"><i class="fa fa-check"></i><b>6.1.2</b> Column Names</a></li>
<li class="chapter" data-level="6.1.3" data-path="6.1-basic-operations-on-tibbles.html"><a href="6.1-basic-operations-on-tibbles.html#column-operations"><i class="fa fa-check"></i><b>6.1.3</b> Column Operations</a></li>
<li class="chapter" data-level="6.1.4" data-path="6.1-basic-operations-on-tibbles.html"><a href="6.1-basic-operations-on-tibbles.html#mutate"><i class="fa fa-check"></i><b>6.1.4</b> <code>mutate</code></a></li>
<li class="chapter" data-level="6.1.5" data-path="6.1-basic-operations-on-tibbles.html"><a href="6.1-basic-operations-on-tibbles.html#concatenate-rows-into-a-tibble"><i class="fa fa-check"></i><b>6.1.5</b> Concatenate rows into a <code>tibble</code></a></li>
<li class="chapter" data-level="6.1.6" data-path="6.1-basic-operations-on-tibbles.html"><a href="6.1-basic-operations-on-tibbles.html#data-subsetting-1"><i class="fa fa-check"></i><b>6.1.6</b> Data Subsetting</a></li>
<li class="chapter" data-level="6.1.7" data-path="6.1-basic-operations-on-tibbles.html"><a href="6.1-basic-operations-on-tibbles.html#dynamic-selection"><i class="fa fa-check"></i><b>6.1.7</b> Dynamic Selection</a></li>
<li class="chapter" data-level="6.1.8" data-path="6.1-basic-operations-on-tibbles.html"><a href="6.1-basic-operations-on-tibbles.html#merge"><i class="fa fa-check"></i><b>6.1.8</b> Merge</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="6.2-pipe-operator.html"><a href="6.2-pipe-operator.html"><i class="fa fa-check"></i><b>6.2</b> Pipe Operator</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="6.2-pipe-operator.html"><a href="6.2-pipe-operator.html#native-pipe"><i class="fa fa-check"></i><b>6.2.1</b> Native Pipe <code>|&gt;</code></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="6.3-categorical-variables.html"><a href="6.3-categorical-variables.html"><i class="fa fa-check"></i><b>6.3</b> Categorical Variables</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="6.3-categorical-variables.html"><a href="6.3-categorical-variables.html#manipulate-string-columns"><i class="fa fa-check"></i><b>6.3.1</b> Manipulate String Columns</a></li>
<li class="chapter" data-level="6.3.2" data-path="6.3-categorical-variables.html"><a href="6.3-categorical-variables.html#factors"><i class="fa fa-check"></i><b>6.3.2</b> Factors</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="6.4-group-and-apply-functions.html"><a href="6.4-group-and-apply-functions.html"><i class="fa fa-check"></i><b>6.4</b> Group and Apply Functions</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="6.4-group-and-apply-functions.html"><a href="6.4-group-and-apply-functions.html#group_by"><i class="fa fa-check"></i><b>6.4.1</b> <code>group_by()</code></a></li>
<li class="chapter" data-level="6.4.2" data-path="6.4-group-and-apply-functions.html"><a href="6.4-group-and-apply-functions.html#subset-rows"><i class="fa fa-check"></i><b>6.4.2</b> Subset rows</a></li>
<li class="chapter" data-level="6.4.3" data-path="6.4-group-and-apply-functions.html"><a href="6.4-group-and-apply-functions.html#summarize"><i class="fa fa-check"></i><b>6.4.3</b> Summarize</a></li>
<li class="chapter" data-level="6.4.4" data-path="6.4-group-and-apply-functions.html"><a href="6.4-group-and-apply-functions.html#split-apply-combine"><i class="fa fa-check"></i><b>6.4.4</b> split-apply-combine</a></li>
<li class="chapter" data-level="6.4.5" data-path="6.4-group-and-apply-functions.html"><a href="6.4-group-and-apply-functions.html#dplyrgroup_modify"><i class="fa fa-check"></i><b>6.4.5</b> <code>dplyr::group_modify()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-graphics.html"><a href="7-graphics.html"><i class="fa fa-check"></i><b>7</b> Graphics</a>
<ul>
<li class="chapter" data-level="" data-path="7-graphics.html"><a href="7-graphics.html#graphic-parameters"><i class="fa fa-check"></i>Graphic Parameters</a></li>
<li class="chapter" data-level="" data-path="7-graphics.html"><a href="7-graphics.html#plot-example"><i class="fa fa-check"></i>Plot example</a></li>
<li class="chapter" data-level="" data-path="7-graphics.html"><a href="7-graphics.html#plot-symbols"><i class="fa fa-check"></i>Plot Symbols</a></li>
<li class="chapter" data-level="7.1" data-path="7.1-goodlooking-colors.html"><a href="7.1-goodlooking-colors.html"><i class="fa fa-check"></i><b>7.1</b> Goodlooking Colors</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="7.1-goodlooking-colors.html"><a href="7.1-goodlooking-colors.html#colorspace-package"><i class="fa fa-check"></i><b>7.1.1</b> <code>colorspace</code> Package</a></li>
<li class="chapter" data-level="7.1.2" data-path="7.1-goodlooking-colors.html"><a href="7.1-goodlooking-colors.html#rcolorbrewer"><i class="fa fa-check"></i><b>7.1.2</b> RColorBrewer</a></li>
<li class="chapter" data-level="7.1.3" data-path="7.1-goodlooking-colors.html"><a href="7.1-goodlooking-colors.html#grey-scale"><i class="fa fa-check"></i><b>7.1.3</b> Grey Scale</a></li>
<li class="chapter" data-level="7.1.4" data-path="7.1-goodlooking-colors.html"><a href="7.1-goodlooking-colors.html#ggsci"><i class="fa fa-check"></i><b>7.1.4</b> <code>ggsci</code></a></li>
<li class="chapter" data-level="7.1.5" data-path="7.1-goodlooking-colors.html"><a href="7.1-goodlooking-colors.html#generate-color-palettes"><i class="fa fa-check"></i><b>7.1.5</b> <strong>Generate Color Palettes</strong></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="7.2-math-expression-in-figures.html"><a href="7.2-math-expression-in-figures.html"><i class="fa fa-check"></i><b>7.2</b> Math Expression in Figures</a></li>
<li class="chapter" data-level="7.3" data-path="7.3-control-graphics-devices.html"><a href="7.3-control-graphics-devices.html"><i class="fa fa-check"></i><b>7.3</b> Control Graphics Devices</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="7.3-control-graphics-devices.html"><a href="7.3-control-graphics-devices.html#save-png"><i class="fa fa-check"></i><b>7.3.1</b> Save PNG</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="7.4-ggplot.html"><a href="7.4-ggplot.html"><i class="fa fa-check"></i><b>7.4</b> ggplot</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="7.4-ggplot.html"><a href="7.4-ggplot.html#dual-y-axis-plot"><i class="fa fa-check"></i><b>7.4.1</b> <strong>Dual y-axis plot</strong></a></li>
<li class="chapter" data-level="7.4.2" data-path="7.4-ggplot.html"><a href="7.4-ggplot.html#aes"><i class="fa fa-check"></i><b>7.4.2</b> <code>aes()</code></a></li>
<li class="chapter" data-level="7.4.3" data-path="7.4-ggplot.html"><a href="7.4-ggplot.html#add-regression-line"><i class="fa fa-check"></i><b>7.4.3</b> Add regression line</a></li>
<li class="chapter" data-level="7.4.4" data-path="7.4-ggplot.html"><a href="7.4-ggplot.html#subplots"><i class="fa fa-check"></i><b>7.4.4</b> Subplots</a></li>
<li class="chapter" data-level="7.4.5" data-path="7.4-ggplot.html"><a href="7.4-ggplot.html#parameters-1"><i class="fa fa-check"></i><b>7.4.5</b> Parameters</a></li>
<li class="chapter" data-level="7.4.6" data-path="7.4-ggplot.html"><a href="7.4-ggplot.html#guides-together-with-guide_legend"><i class="fa fa-check"></i><b>7.4.6</b> <code>guides()</code>, together with <code>guide_legend()</code></a></li>
<li class="chapter" data-level="7.4.7" data-path="7.4-ggplot.html"><a href="7.4-ggplot.html#template-for-multi-series"><i class="fa fa-check"></i><b>7.4.7</b> Template for multi-series</a></li>
<li class="chapter" data-level="7.4.8" data-path="7.4-ggplot.html"><a href="7.4-ggplot.html#grid.gedit"><i class="fa fa-check"></i><b>7.4.8</b> <code>grid.gedit()</code></a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="7.5-plot-raster-data.html"><a href="7.5-plot-raster-data.html"><i class="fa fa-check"></i><b>7.5</b> plot <code>Raster</code> data</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="7.5-plot-raster-data.html"><a href="7.5-plot-raster-data.html#add-patterns-to-shapes"><i class="fa fa-check"></i><b>7.5.1</b> Add Patterns to Shapes</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="7.6-histogram.html"><a href="7.6-histogram.html"><i class="fa fa-check"></i><b>7.6</b> Histogram</a></li>
<li class="chapter" data-level="7.7" data-path="7.7-qq-plot.html"><a href="7.7-qq-plot.html"><i class="fa fa-check"></i><b>7.7</b> QQ-plot</a></li>
<li class="chapter" data-level="7.8" data-path="7.8-heatmap.html"><a href="7.8-heatmap.html"><i class="fa fa-check"></i><b>7.8</b> Heatmap</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="8-time-series.html"><a href="8-time-series.html"><i class="fa fa-check"></i><b>8</b> Time Series</a>
<ul>
<li class="chapter" data-level="8.1" data-path="8.1-date.html"><a href="8.1-date.html"><i class="fa fa-check"></i><b>8.1</b> Date</a></li>
<li class="chapter" data-level="8.2" data-path="8.2-process-data.html"><a href="8.2-process-data.html"><i class="fa fa-check"></i><b>8.2</b> Process Data</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="8.2-process-data.html"><a href="8.2-process-data.html#tidyquant"><i class="fa fa-check"></i><b>8.2.1</b> <code>tidyquant</code></a></li>
<li class="chapter" data-level="8.2.2" data-path="8.2-process-data.html"><a href="8.2-process-data.html#from-tibble-to-xts"><i class="fa fa-check"></i><b>8.2.2</b> From tibble to <code>xts</code></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="8.3-portfolio-return.html"><a href="8.3-portfolio-return.html"><i class="fa fa-check"></i><b>8.3</b> Portfolio Return</a></li>
<li class="chapter" data-level="8.4" data-path="8.4-plot-ts.html"><a href="8.4-plot-ts.html"><i class="fa fa-check"></i><b>8.4</b> Plot TS</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="8.4-plot-ts.html"><a href="8.4-plot-ts.html#plot.xts"><i class="fa fa-check"></i><b>8.4.1</b> <code>plot.xts</code></a></li>
<li class="chapter" data-level="8.4.2" data-path="8.4-plot-ts.html"><a href="8.4-plot-ts.html#autoplot"><i class="fa fa-check"></i><b>8.4.2</b> <code>autoplot</code></a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="8.5-time-series-regression.html"><a href="8.5-time-series-regression.html"><i class="fa fa-check"></i><b>8.5</b> Time Series Regression</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="8.5-time-series-regression.html"><a href="8.5-time-series-regression.html#lag-polynomial"><i class="fa fa-check"></i><b>8.5.1</b> Lag Polynomial</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="9-regression.html"><a href="9-regression.html"><i class="fa fa-check"></i><b>9</b> Regression</a>
<ul>
<li class="chapter" data-level="9.1" data-path="9.1-ols.html"><a href="9.1-ols.html"><i class="fa fa-check"></i><b>9.1</b> OLS</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="9.1-ols.html"><a href="9.1-ols.html#get-the-coef-estimates"><i class="fa fa-check"></i><b>9.1.1</b> Get the coef estimates</a></li>
<li class="chapter" data-level="9.1.2" data-path="9.1-ols.html"><a href="9.1-ols.html#covariance-matrix"><i class="fa fa-check"></i><b>9.1.2</b> Covariance Matrix</a></li>
<li class="chapter" data-level="9.1.3" data-path="9.1-ols.html"><a href="9.1-ols.html#model-performance"><i class="fa fa-check"></i><b>9.1.3</b> Model performance</a></li>
<li class="chapter" data-level="9.1.4" data-path="9.1-ols.html"><a href="9.1-ols.html#model-summary"><i class="fa fa-check"></i><b>9.1.4</b> Model Summary</a></li>
<li class="chapter" data-level="9.1.5" data-path="9.1-ols.html"><a href="9.1-ols.html#dummy-variable"><i class="fa fa-check"></i><b>9.1.5</b> Dummy variable</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="9.2-panel.html"><a href="9.2-panel.html"><i class="fa fa-check"></i><b>9.2</b> Panel</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="9.2-panel.html"><a href="9.2-panel.html#dynamic-panel"><i class="fa fa-check"></i><b>9.2.1</b> Dynamic Panel</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="10-machine-learning.html"><a href="10-machine-learning.html"><i class="fa fa-check"></i><b>10</b> Machine Learning</a>
<ul>
<li class="chapter" data-level="10.1" data-path="10.1-imbalanced-datasets.html"><a href="10.1-imbalanced-datasets.html"><i class="fa fa-check"></i><b>10.1</b> Imbalanced datasets</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="10.1-imbalanced-datasets.html"><a href="10.1-imbalanced-datasets.html#downsampling-and-upweighting"><i class="fa fa-check"></i><b>10.1.1</b> Downsampling and Upweighting</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="10.2-random-forest.html"><a href="10.2-random-forest.html"><i class="fa fa-check"></i><b>10.2</b> Random Forest</a>
<ul>
<li class="chapter" data-level="" data-path="10.2-random-forest.html"><a href="10.2-random-forest.html#implementation-in-r"><i class="fa fa-check"></i>Implementation in R</a></li>
<li class="chapter" data-level="" data-path="10.2-random-forest.html"><a href="10.2-random-forest.html#imbalance-classification"><i class="fa fa-check"></i>Imbalance Classification</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="10.3-neural-network.html"><a href="10.3-neural-network.html"><i class="fa fa-check"></i><b>10.3</b> Neural Network</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="11-stata.html"><a href="11-stata.html"><i class="fa fa-check"></i><b>11</b> Stata</a>
<ul>
<li class="chapter" data-level="11.1" data-path="11.1-basic-syntax.html"><a href="11.1-basic-syntax.html"><i class="fa fa-check"></i><b>11.1</b> Basic syntax</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="11.1-basic-syntax.html"><a href="11.1-basic-syntax.html#system-variables"><i class="fa fa-check"></i><b>11.1.1</b> System Variables</a></li>
<li class="chapter" data-level="11.1.2" data-path="11.1-basic-syntax.html"><a href="11.1-basic-syntax.html#matrix"><i class="fa fa-check"></i><b>11.1.2</b> Matrix</a></li>
<li class="chapter" data-level="11.1.3" data-path="11.1-basic-syntax.html"><a href="11.1-basic-syntax.html#factor-variables"><i class="fa fa-check"></i><b>11.1.3</b> Factor Variables</a></li>
<li class="chapter" data-level="11.1.4" data-path="11.1-basic-syntax.html"><a href="11.1-basic-syntax.html#time-series-varlists"><i class="fa fa-check"></i><b>11.1.4</b> Time series varlists</a></li>
<li class="chapter" data-level="11.1.5" data-path="11.1-basic-syntax.html"><a href="11.1-basic-syntax.html#labels"><i class="fa fa-check"></i><b>11.1.5</b> Labels</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="11.2-data-manipulation.html"><a href="11.2-data-manipulation.html"><i class="fa fa-check"></i><b>11.2</b> Data Manipulation</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="11.2-data-manipulation.html"><a href="11.2-data-manipulation.html#import-and-export"><i class="fa fa-check"></i><b>11.2.1</b> Import and Export</a></li>
<li class="chapter" data-level="11.2.2" data-path="11.2-data-manipulation.html"><a href="11.2-data-manipulation.html#save-estimation-results"><i class="fa fa-check"></i><b>11.2.2</b> Save Estimation Results</a></li>
<li class="chapter" data-level="11.2.3" data-path="11.2-data-manipulation.html"><a href="11.2-data-manipulation.html#stored-results"><i class="fa fa-check"></i><b>11.2.3</b> Stored Results</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="11.3-predict.html"><a href="11.3-predict.html"><i class="fa fa-check"></i><b>11.3</b> Predict</a></li>
<li class="chapter" data-level="11.4" data-path="11.4-forecast.html"><a href="11.4-forecast.html"><i class="fa fa-check"></i><b>11.4</b> Forecast</a>
<ul>
<li class="chapter" data-level="" data-path="11.4-forecast.html"><a href="11.4-forecast.html#add-equationsidentifies"><i class="fa fa-check"></i>Add equations/identifies</a></li>
<li class="chapter" data-level="" data-path="11.4-forecast.html"><a href="11.4-forecast.html#solve-the-foreceast"><i class="fa fa-check"></i>Solve the foreceast</a></li>
<li class="chapter" data-level="" data-path="11.4-forecast.html"><a href="11.4-forecast.html#use-example-forecast-a-panel"><i class="fa fa-check"></i>Use example: forecast a panel</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="11.5-panel-1.html"><a href="11.5-panel-1.html"><i class="fa fa-check"></i><b>11.5</b> Panel</a></li>
<li class="chapter" data-level="11.6" data-path="11.6-arellano-bond-estimator.html"><a href="11.6-arellano-bond-estimator.html"><i class="fa fa-check"></i><b>11.6</b> Arellano-Bond Estimator</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="11.6-arellano-bond-estimator.html"><a href="11.6-arellano-bond-estimator.html#xtabond2"><i class="fa fa-check"></i><b>11.6.1</b> xtabond2</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<head>
    <script> 
        function myFunction(id) {
          var x = document.getElementById(id); 
          if (x.style.display === "none") {
            x.style.display = "block";
          } else {
            x.style.display = "none";
          }
        }
    </script>
</head>
<div id="ggplot" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> ggplot<a href="7.4-ggplot.html#ggplot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Reference: <a href="https://ggplot2.tidyverse.org/reference/index.html" class="uri">https://ggplot2.tidyverse.org/reference/index.html</a></p>
<p><strong>Change global settings</strong></p>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="7.4-ggplot.html#cb514-1" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>()) <span class="co"># change default theme to theme_bw() globally</span></span></code></pre></div>
<p>You start with <code>ggplot()</code>, supply a dataset and aesthetic mapping (with <code>aes()</code>). You then add on layers (like <code>geom_point()</code> or <code>geom_histogram()</code>), scales (like <code>scale_colour_brewer()</code>), faceting specifications (like <code>facet_wrap()</code>) and coordinate systems (like <code>coord_flip()</code>).</p>
<p>Default theme: <code>theme_gray()</code> grey background and white gridlines.</p>
<p><code>ggplot(data = NULL, mapping = aes(), ...)</code> is used to construct the initial plot object, and is almost always followed by a plus sign (<code>+</code>) to add components to the plot. <a href="https://ggplot2.tidyverse.org/reference/ggplot.html">Doc</a>.</p>
<p>The <code>data =</code> and <code>mapping =</code> specifications in the arguments are optional (and are often omitted in practice), so long as the data and the mapping values are passed into the function in the right order.</p>
<p>There are three common patterns used to invoke <code>ggplot()</code>:</p>
<ul>
<li><p><code>ggplot(data = df, mapping = aes(x, y, other aesthetics))</code></p>
<p>Recommended if all layers use the same data and the same set of aesthetics, although this method can also be used when adding a layer using data from another data frame.</p></li>
<li><p><code>ggplot(data = df)</code></p>
<p>This is useful when one data frame is used predominantly for the plot, but the aesthetics vary from one layer to another. Different x/y-axis.</p></li>
<li><p><code>ggplot()</code></p>
<p>This is useful when multiple data frames are used to produce different layers, as is often the case in complex graphics.</p></li>
</ul>
<p>Create a <span style="color:#008B45"><strong>customized figure theme</strong></span> code snippet that could be used repetitively.</p>
<p><code>theme()</code> note that when you call it, just use <code>+ mytheme</code> w/o parentheses as it is not a function — it is a theme setting.</p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="7.4-ggplot.html#cb515-1" tabindex="-1"></a>mytheme <span class="ot">&lt;-</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="co"># disable legend</span></span>
<span id="cb515-2"><a href="7.4-ggplot.html#cb515-2" tabindex="-1"></a>                 <span class="at">legend.spacing.y =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">&#39;mm&#39;</span>), <span class="co"># spacing between legend title and legend items</span></span>
<span id="cb515-3"><a href="7.4-ggplot.html#cb515-3" tabindex="-1"></a>                         <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>,<span class="st">&quot;line&quot;</span>), <span class="co"># vertical spacing between legend items</span></span>
<span id="cb515-4"><a href="7.4-ggplot.html#cb515-4" tabindex="-1"></a>                         <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="at">t=</span><span class="dv">0</span>, <span class="at">b=</span><span class="dv">0</span>, <span class="at">unit=</span><span class="st">&quot;mm&quot;</span>), <span class="co"># legend box margins</span></span>
<span id="cb515-5"><a href="7.4-ggplot.html#cb515-5" tabindex="-1"></a>                 <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb515-6"><a href="7.4-ggplot.html#cb515-6" tabindex="-1"></a>                 <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.2</span>)), <span class="co"># use `rel()` to change proportionally to base font size; or a number to specify absolute size as follows;</span></span>
<span id="cb515-7"><a href="7.4-ggplot.html#cb515-7" tabindex="-1"></a>                 <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>), <span class="co"># tick labels along axes</span></span>
<span id="cb515-8"><a href="7.4-ggplot.html#cb515-8" tabindex="-1"></a>                 <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>() <span class="co"># remove minor gridlines</span></span>
<span id="cb515-9"><a href="7.4-ggplot.html#cb515-9" tabindex="-1"></a>                )</span>
<span id="cb515-10"><a href="7.4-ggplot.html#cb515-10" tabindex="-1"></a>                </span>
<span id="cb515-11"><a href="7.4-ggplot.html#cb515-11" tabindex="-1"></a><span class="co"># p is a ggplot() subject</span></span>
<span id="cb515-12"><a href="7.4-ggplot.html#cb515-12" tabindex="-1"></a>p <span class="sc">+</span> mytheme</span></code></pre></div>
<p><code>rel(x)</code> specify sizes relative to the parent.</p>
<p><span style="color:#008B45"><code>theme_bw(base_size = 14)</code></span> the default font size is 11 pt, which can be too small. Set <code>base_size=14</code> to enlarge the font size for a specific theme.</p>
<p><code>theme_get()</code> returns the current active theme.</p>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="7.4-ggplot.html#cb516-1" tabindex="-1"></a><span class="co"># get default values of theme parameters</span></span>
<span id="cb516-2"><a href="7.4-ggplot.html#cb516-2" tabindex="-1"></a><span class="fu">theme_get</span>()<span class="sc">$</span>plot.margin </span></code></pre></div>
<p><strong>Check default options for a specific theme</strong></p>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="7.4-ggplot.html#cb517-1" tabindex="-1"></a><span class="fu">theme_bw</span>()<span class="sc">$</span>legend.spacing</span></code></pre></div>
<p>Legend layout</p>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="7.4-ggplot.html#cb518-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>))</span></code></pre></div>
<hr />
<p><strong>Theme</strong></p>
<p>Explore themes: <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="uri">https://ggplot2.tidyverse.org/reference/ggtheme.html</a></p>
<p>default: <code>theme_gray()</code> (with grey background)</p>
<p>normal: <strong><code>theme_bw()</code></strong> (recommended 结构清晰)</p>
<p>coordinates: <code>theme_minimal()</code> (no axis borders 极简风) 没有背景填充色，深色模式下预览困难。</p>
<p>with no grid: <code>theme_classic()</code> (hard to read)</p>
<p><strong>Wide table to Long table</strong></p>
<p><code>tidyr::gather(data, key = "key", value = "value", ...)</code> convert data frame to key-value <strong>long format</strong>.</p>
<p><code>...</code> is a selection of columns. If empty, all variables are selected. You can supply bare variable names, select all variables between x and z with <code>x:z</code>, exclude y with <code>-y</code>.</p>
<ul>
<li><p><code>key</code> one identifier column that you use to idendify groups, store the <strong>names</strong> of columns that you want to gather/stack;</p></li>
<li><p><code>value</code> one value column name that put <strong>values</strong> in <code>key</code> columns;</p></li>
<li><p><code>...</code> specification of columns to gather/stack. Allowed values are:</p>
<ul>
<li><p>variable names, put them just in a sequence, do not need to wrap it in a vector</p></li>
<li><p>if you want to select all variables between a and e, use a:e. Or could use position index e.g., 1:3.</p></li>
<li><p>if you want to <strong><em>exclude</em></strong> a column name y use <code>-y</code>, usually the <strong>index/identifier</strong> of the columnss.</p></li>
</ul></li>
</ul>
<p><code>df %&gt;% pivot_longer(c(x, y, z), names_to = "key", values_to = "value")</code></p>
<p>​ is equivalent to <code>df %&gt;% gather("key", "value", x, y, z)</code>, more recommended.</p>
<p><strong>Long table to wide table</strong> <code>spread</code>, reverse <code>gather()</code></p>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="7.4-ggplot.html#cb519-1" tabindex="-1"></a><span class="fu">spread</span>(data, key, value, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">convert =</span> <span class="cn">FALSE</span>, <span class="at">drop =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p><code>key</code> the column in the long table that will become factor/columns in wide table; the number of new columns equals to the number of categories in <code>key</code>; the columns are filled by <code>value</code>;</p>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="7.4-ggplot.html#cb520-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">month=</span><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">2</span>),</span>
<span id="cb520-2"><a href="7.4-ggplot.html#cb520-2" tabindex="-1"></a>                 <span class="at">student=</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Amy&quot;</span>, <span class="st">&quot;Bob&quot;</span>), <span class="at">each=</span><span class="dv">3</span>),</span>
<span id="cb520-3"><a href="7.4-ggplot.html#cb520-3" tabindex="-1"></a>                 <span class="at">A=</span><span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">9</span>),</span>
<span id="cb520-4"><a href="7.4-ggplot.html#cb520-4" tabindex="-1"></a>                 <span class="at">B=</span><span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>))</span>
<span id="cb520-5"><a href="7.4-ggplot.html#cb520-5" tabindex="-1"></a></span>
<span id="cb520-6"><a href="7.4-ggplot.html#cb520-6" tabindex="-1"></a><span class="co">#       month student A B</span></span>
<span id="cb520-7"><a href="7.4-ggplot.html#cb520-7" tabindex="-1"></a><span class="co"># 1     1     Amy   9 6</span></span>
<span id="cb520-8"><a href="7.4-ggplot.html#cb520-8" tabindex="-1"></a><span class="co"># 2     2     Amy   7 7</span></span>
<span id="cb520-9"><a href="7.4-ggplot.html#cb520-9" tabindex="-1"></a><span class="co"># 3     3     Amy   6 8</span></span>
<span id="cb520-10"><a href="7.4-ggplot.html#cb520-10" tabindex="-1"></a><span class="co"># 4     1     Bob   8 5</span></span>
<span id="cb520-11"><a href="7.4-ggplot.html#cb520-11" tabindex="-1"></a><span class="co"># 5     2     Bob   6 6</span></span>
<span id="cb520-12"><a href="7.4-ggplot.html#cb520-12" tabindex="-1"></a><span class="co"># 6     3     Bob   9 7</span></span>
<span id="cb520-13"><a href="7.4-ggplot.html#cb520-13" tabindex="-1"></a></span>
<span id="cb520-14"><a href="7.4-ggplot.html#cb520-14" tabindex="-1"></a><span class="do">## 1. construct long table</span></span>
<span id="cb520-15"><a href="7.4-ggplot.html#cb520-15" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb520-16"><a href="7.4-ggplot.html#cb520-16" tabindex="-1"></a>  <span class="fu">gather</span>(variable, value, <span class="sc">-</span>(month<span class="sc">:</span>student))</span>
<span id="cb520-17"><a href="7.4-ggplot.html#cb520-17" tabindex="-1"></a><span class="co">#       month student variable value</span></span>
<span id="cb520-18"><a href="7.4-ggplot.html#cb520-18" tabindex="-1"></a><span class="co"># 1      1     Amy        A     9</span></span>
<span id="cb520-19"><a href="7.4-ggplot.html#cb520-19" tabindex="-1"></a><span class="co"># 2      2     Amy        A     7</span></span>
<span id="cb520-20"><a href="7.4-ggplot.html#cb520-20" tabindex="-1"></a><span class="co"># 3      3     Amy        A     6</span></span>
<span id="cb520-21"><a href="7.4-ggplot.html#cb520-21" tabindex="-1"></a><span class="co"># 4      1     Bob        A     8</span></span>
<span id="cb520-22"><a href="7.4-ggplot.html#cb520-22" tabindex="-1"></a><span class="co"># 5      2     Bob        A     6</span></span>
<span id="cb520-23"><a href="7.4-ggplot.html#cb520-23" tabindex="-1"></a><span class="co"># 6      3     Bob        A     9</span></span>
<span id="cb520-24"><a href="7.4-ggplot.html#cb520-24" tabindex="-1"></a><span class="co"># 7      1     Amy        B     6</span></span>
<span id="cb520-25"><a href="7.4-ggplot.html#cb520-25" tabindex="-1"></a><span class="co"># 8      2     Amy        B     7</span></span>
<span id="cb520-26"><a href="7.4-ggplot.html#cb520-26" tabindex="-1"></a><span class="co"># 9      3     Amy        B     8</span></span>
<span id="cb520-27"><a href="7.4-ggplot.html#cb520-27" tabindex="-1"></a><span class="co"># 10     1     Bob        B     5</span></span>
<span id="cb520-28"><a href="7.4-ggplot.html#cb520-28" tabindex="-1"></a><span class="co"># 11     2     Bob        B     6</span></span>
<span id="cb520-29"><a href="7.4-ggplot.html#cb520-29" tabindex="-1"></a><span class="co"># 12     3     Bob        B     7</span></span>
<span id="cb520-30"><a href="7.4-ggplot.html#cb520-30" tabindex="-1"></a></span>
<span id="cb520-31"><a href="7.4-ggplot.html#cb520-31" tabindex="-1"></a><span class="do">## 2. create identifier column that will become columns in the `spread` step</span></span>
<span id="cb520-32"><a href="7.4-ggplot.html#cb520-32" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb520-33"><a href="7.4-ggplot.html#cb520-33" tabindex="-1"></a>  <span class="fu">gather</span>(variable, value, <span class="sc">-</span>(month<span class="sc">:</span>student)) <span class="sc">%&gt;%</span></span>
<span id="cb520-34"><a href="7.4-ggplot.html#cb520-34" tabindex="-1"></a>  <span class="fu">unite</span>(temp, student, variable)</span>
<span id="cb520-35"><a href="7.4-ggplot.html#cb520-35" tabindex="-1"></a><span class="co">#    month  temp value</span></span>
<span id="cb520-36"><a href="7.4-ggplot.html#cb520-36" tabindex="-1"></a><span class="co"># 1      1 Amy_A     9</span></span>
<span id="cb520-37"><a href="7.4-ggplot.html#cb520-37" tabindex="-1"></a><span class="co"># 2      2 Amy_A     7</span></span>
<span id="cb520-38"><a href="7.4-ggplot.html#cb520-38" tabindex="-1"></a><span class="co"># 3      3 Amy_A     6</span></span>
<span id="cb520-39"><a href="7.4-ggplot.html#cb520-39" tabindex="-1"></a><span class="co"># 4      1 Bob_A     8</span></span>
<span id="cb520-40"><a href="7.4-ggplot.html#cb520-40" tabindex="-1"></a><span class="co"># 5      2 Bob_A     6</span></span>
<span id="cb520-41"><a href="7.4-ggplot.html#cb520-41" tabindex="-1"></a><span class="co"># 6      3 Bob_A     9</span></span>
<span id="cb520-42"><a href="7.4-ggplot.html#cb520-42" tabindex="-1"></a><span class="co"># 7      1 Amy_B     6</span></span>
<span id="cb520-43"><a href="7.4-ggplot.html#cb520-43" tabindex="-1"></a><span class="co"># 8      2 Amy_B     7</span></span>
<span id="cb520-44"><a href="7.4-ggplot.html#cb520-44" tabindex="-1"></a><span class="co"># 9      3 Amy_B     8</span></span>
<span id="cb520-45"><a href="7.4-ggplot.html#cb520-45" tabindex="-1"></a><span class="co"># 10     1 Bob_B     5</span></span>
<span id="cb520-46"><a href="7.4-ggplot.html#cb520-46" tabindex="-1"></a><span class="co"># 11     2 Bob_B     6</span></span>
<span id="cb520-47"><a href="7.4-ggplot.html#cb520-47" tabindex="-1"></a><span class="co"># 12     3 Bob_B     7</span></span>
<span id="cb520-48"><a href="7.4-ggplot.html#cb520-48" tabindex="-1"></a></span>
<span id="cb520-49"><a href="7.4-ggplot.html#cb520-49" tabindex="-1"></a><span class="do">## 3. `spread` long table, spread the column containing the factor/identifier info</span></span>
<span id="cb520-50"><a href="7.4-ggplot.html#cb520-50" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb520-51"><a href="7.4-ggplot.html#cb520-51" tabindex="-1"></a>  <span class="fu">gather</span>(variable, value, <span class="sc">-</span>(month<span class="sc">:</span>student)) sub<span class="sc">%&gt;%</span></span>
<span id="cb520-52"><a href="7.4-ggplot.html#cb520-52" tabindex="-1"></a>  <span class="fu">unite</span>(temp, student, variable) <span class="sc">%&gt;%</span> <span class="co"># first unite</span></span>
<span id="cb520-53"><a href="7.4-ggplot.html#cb520-53" tabindex="-1"></a>  <span class="fu">spread</span>(temp, value) <span class="co"># then spread</span></span>
<span id="cb520-54"><a href="7.4-ggplot.html#cb520-54" tabindex="-1"></a>  </span>
<span id="cb520-55"><a href="7.4-ggplot.html#cb520-55" tabindex="-1"></a><span class="co">#   month Amy_A Amy_B Bob_A Bob_B</span></span>
<span id="cb520-56"><a href="7.4-ggplot.html#cb520-56" tabindex="-1"></a><span class="co"># 1     1     9     6     8     5</span></span>
<span id="cb520-57"><a href="7.4-ggplot.html#cb520-57" tabindex="-1"></a><span class="co"># 2     2     7     7     6     6</span></span>
<span id="cb520-58"><a href="7.4-ggplot.html#cb520-58" tabindex="-1"></a><span class="co"># 3     3     6     8     9     7</span></span></code></pre></div>
<p><code>unite(data, col, ..., sep = "_", remove = TRUE, na.rm = FALSE)</code> paste together multiple columns into a single column or variable (often used as <code>factor</code> identifier for long table); return a <code>string</code> column.</p>
<p><code>annotate(geom = 'text', label = 'Africa', x = Inf, y = Inf, hjust = 2, vjust = 2)</code> Add text/annotation to a designated position.</p>
<ul>
<li><p>Justification (<code>hjust</code>, <code>vjust</code>): Horizontal and vertical justification have the same parameterisation, either a string (“top”, “middle”, “bottom”, “left”, “center”, “right”) or a number between 0 and 1:</p>
<ul>
<li>top = 1, middle = 0.5, bottom = 0</li>
<li>left = 0, center = 0.5, right = 1</li>
<li>Note that you <em>can</em> use numbers outside the range (0, 1), but it’s not recommended.</li>
</ul></li>
<li><p>If <code>label</code> is a <code>TeX</code> expression, then should use</p>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="7.4-ggplot.html#cb521-1" tabindex="-1"></a> <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="dv">3</span>, <span class="at">y=</span><span class="dv">40</span>, <span class="at">label=</span><span class="fu">TeX</span>(eqn, <span class="at">output=</span><span class="st">&quot;character&quot;</span>),</span>
<span id="cb521-2"><a href="7.4-ggplot.html#cb521-2" tabindex="-1"></a>           <span class="at">hjust=</span><span class="dv">0</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>)</span></code></pre></div></li>
</ul>
<hr />
<div id="dual-y-axis-plot" class="section level3 hasAnchor" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> <strong>Dual y-axis plot</strong><a href="7.4-ggplot.html#dual-y-axis-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="7.4-ggplot.html#cb522-1" tabindex="-1"></a>rescaleY <span class="ot">&lt;-</span> <span class="cf">function</span>(y1, y2){</span>
<span id="cb522-2"><a href="7.4-ggplot.html#cb522-2" tabindex="-1"></a>  <span class="co"># useful for plotting figures with dual axis but with different range</span></span>
<span id="cb522-3"><a href="7.4-ggplot.html#cb522-3" tabindex="-1"></a>  <span class="co"># y1 is the primary axis    # target to</span></span>
<span id="cb522-4"><a href="7.4-ggplot.html#cb522-4" tabindex="-1"></a>  <span class="co"># y2 is the secondary axis  # origin from</span></span>
<span id="cb522-5"><a href="7.4-ggplot.html#cb522-5" tabindex="-1"></a>  <span class="co"># rescale y2 to match y1 range</span></span>
<span id="cb522-6"><a href="7.4-ggplot.html#cb522-6" tabindex="-1"></a>  <span class="co"># return a-intercept, b-slope</span></span>
<span id="cb522-7"><a href="7.4-ggplot.html#cb522-7" tabindex="-1"></a>  ylim1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(y1), <span class="fu">max</span>(y1))  </span>
<span id="cb522-8"><a href="7.4-ggplot.html#cb522-8" tabindex="-1"></a>  ylim2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(y2), <span class="fu">max</span>(y2))</span>
<span id="cb522-9"><a href="7.4-ggplot.html#cb522-9" tabindex="-1"></a>  b <span class="ot">&lt;-</span> (ylim1[<span class="dv">2</span>]<span class="sc">-</span>ylim1[<span class="dv">1</span>])<span class="sc">/</span>(ylim2[<span class="dv">2</span>]<span class="sc">-</span>ylim2[<span class="dv">1</span>])</span>
<span id="cb522-10"><a href="7.4-ggplot.html#cb522-10" tabindex="-1"></a>  a <span class="ot">&lt;-</span> ylim1[<span class="dv">1</span>]<span class="sc">-</span>b<span class="sc">*</span>ylim2[<span class="dv">1</span>]</span>
<span id="cb522-11"><a href="7.4-ggplot.html#cb522-11" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">c</span>(a,b)) </span>
<span id="cb522-12"><a href="7.4-ggplot.html#cb522-12" tabindex="-1"></a>}</span>
<span id="cb522-13"><a href="7.4-ggplot.html#cb522-13" tabindex="-1"></a></span>
<span id="cb522-14"><a href="7.4-ggplot.html#cb522-14" tabindex="-1"></a>scaleFactor <span class="ot">&lt;-</span> <span class="fu">rescaleY</span>(the_model_df<span class="sc">$</span>temp, the_model_df<span class="sc">$</span>rsds)  <span class="co"># rescale rsds to match the range with temp</span></span>
<span id="cb522-15"><a href="7.4-ggplot.html#cb522-15" tabindex="-1"></a></span>
<span id="cb522-16"><a href="7.4-ggplot.html#cb522-16" tabindex="-1"></a><span class="fu">dev.new</span>()</span>
<span id="cb522-17"><a href="7.4-ggplot.html#cb522-17" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(the_model_df, <span class="fu">aes</span>(<span class="at">x =</span> yr)) <span class="sc">+</span></span>
<span id="cb522-18"><a href="7.4-ggplot.html#cb522-18" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> temp, <span class="at">colour =</span> <span class="st">&quot;tmp&quot;</span>)) <span class="sc">+</span> <span class="co"># bluish</span></span>
<span id="cb522-19"><a href="7.4-ggplot.html#cb522-19" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> scaleFactor[<span class="dv">1</span>]<span class="sc">+</span>rsds<span class="sc">*</span>scaleFactor[<span class="dv">2</span>], <span class="at">colour =</span> <span class="st">&quot;rsds&quot;</span>)) <span class="sc">+</span> <span class="co"># orange</span></span>
<span id="cb522-20"><a href="7.4-ggplot.html#cb522-20" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Y series&quot;</span>, <span class="co"># legend name</span></span>
<span id="cb522-21"><a href="7.4-ggplot.html#cb522-21" tabindex="-1"></a>                       <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;tmp&quot;</span><span class="ot">=</span><span class="st">&quot;#00BFC4&quot;</span>, <span class="st">&quot;rsds&quot;</span><span class="ot">=</span><span class="st">&quot;#F8766D&quot;</span>), <span class="co"># named vector for color scale, specifying colors you want for each series</span></span>
<span id="cb522-22"><a href="7.4-ggplot.html#cb522-22" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;tmp&quot;</span>, <span class="st">&quot;rsds&quot;</span>), <span class="co"># specify order of scales showing up in legend</span></span>
<span id="cb522-23"><a href="7.4-ggplot.html#cb522-23" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;temperature&quot;</span>, <span class="st">&quot;radiation&quot;</span>) <span class="co"># names/text show up at scales</span></span>
<span id="cb522-24"><a href="7.4-ggplot.html#cb522-24" tabindex="-1"></a>                      ) <span class="sc">+</span></span>
<span id="cb522-25"><a href="7.4-ggplot.html#cb522-25" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Temperature [K]&quot;</span>,</span>
<span id="cb522-26"><a href="7.4-ggplot.html#cb522-26" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>(.<span class="sc">-</span>scaleFactor[<span class="dv">1</span>])<span class="sc">/</span>scaleFactor[<span class="dv">2</span>], <span class="at">name =</span> <span class="st">&quot;Radiation [Wm^-2]&quot;</span>)) <span class="sc">+</span></span>
<span id="cb522-27"><a href="7.4-ggplot.html#cb522-27" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&#39;year&#39;</span>, <span class="at">title=</span>the_model) <span class="sc">+</span></span>
<span id="cb522-28"><a href="7.4-ggplot.html#cb522-28" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="co"># remove legend title</span></span>
<span id="cb522-29"><a href="7.4-ggplot.html#cb522-29" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>), <span class="co"># change legend font size to smaller</span></span>
<span id="cb522-30"><a href="7.4-ggplot.html#cb522-30" tabindex="-1"></a>        <span class="co"># axis.title.x =  element_blank(), # remove x axis title</span></span>
<span id="cb522-31"><a href="7.4-ggplot.html#cb522-31" tabindex="-1"></a>        <span class="at">axis.title.y.right=</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;#F8766D&quot;</span>), <span class="co"># y axis label</span></span>
<span id="cb522-32"><a href="7.4-ggplot.html#cb522-32" tabindex="-1"></a>        <span class="at">axis.text.y.right=</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;#F8766D&quot;</span>))</span>
<span id="cb522-33"><a href="7.4-ggplot.html#cb522-33" tabindex="-1"></a>p</span>
<span id="cb522-34"><a href="7.4-ggplot.html#cb522-34" tabindex="-1"></a></span>
<span id="cb522-35"><a href="7.4-ggplot.html#cb522-35" tabindex="-1"></a><span class="co"># save to file</span></span>
<span id="cb522-36"><a href="7.4-ggplot.html#cb522-36" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;name.png&quot;</span>, <span class="at">path=</span>fig_dir, <span class="at">width=</span><span class="fl">8.93</span>, <span class="at">height=</span><span class="fl">5.74</span>, <span class="at">units=</span><span class="st">&quot;in&quot;</span>, <span class="at">dpi=</span><span class="dv">300</span>)</span>
<span id="cb522-37"><a href="7.4-ggplot.html#cb522-37" tabindex="-1"></a></span>
<span id="cb522-38"><a href="7.4-ggplot.html#cb522-38" tabindex="-1"></a>f_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;./figures/&quot;</span>, <span class="st">&quot;pre_2.png&quot;</span>)</span>
<span id="cb522-39"><a href="7.4-ggplot.html#cb522-39" tabindex="-1"></a>f_name</span>
<span id="cb522-40"><a href="7.4-ggplot.html#cb522-40" tabindex="-1"></a>ppi <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb522-41"><a href="7.4-ggplot.html#cb522-41" tabindex="-1"></a><span class="fu">png</span>(f_name, <span class="at">width=</span><span class="fl">7.96</span><span class="sc">*</span>ppi, <span class="at">height=</span><span class="fl">4.19</span><span class="sc">*</span>ppi, <span class="at">res=</span>ppi)</span>
<span id="cb522-42"><a href="7.4-ggplot.html#cb522-42" tabindex="-1"></a><span class="fu">print</span> (p)</span>
<span id="cb522-43"><a href="7.4-ggplot.html#cb522-43" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb522-44"><a href="7.4-ggplot.html#cb522-44" tabindex="-1"></a></span>
<span id="cb522-45"><a href="7.4-ggplot.html#cb522-45" tabindex="-1"></a></span>
<span id="cb522-46"><a href="7.4-ggplot.html#cb522-46" tabindex="-1"></a>plot_png <span class="ot">&lt;-</span> <span class="cf">function</span>(p, f_name, width, height, <span class="at">ppi=</span><span class="dv">300</span>){</span>
<span id="cb522-47"><a href="7.4-ggplot.html#cb522-47" tabindex="-1"></a>    <span class="co"># a plot wrapper</span></span>
<span id="cb522-48"><a href="7.4-ggplot.html#cb522-48" tabindex="-1"></a>    <span class="fu">png</span>(f_name, <span class="at">width=</span>width<span class="sc">*</span>ppi, <span class="at">height=</span>height<span class="sc">*</span>ppi, <span class="at">res=</span>ppi)</span>
<span id="cb522-49"><a href="7.4-ggplot.html#cb522-49" tabindex="-1"></a>    <span class="fu">print</span> (p)</span>
<span id="cb522-50"><a href="7.4-ggplot.html#cb522-50" tabindex="-1"></a>    <span class="fu">invisible</span>(<span class="fu">dev.off</span>())</span>
<span id="cb522-51"><a href="7.4-ggplot.html#cb522-51" tabindex="-1"></a>}</span></code></pre></div>
<p>The second axis could be either the second <code>x</code> or <code>y</code> axis.</p>
<p><code>sec.axis(trans = NULL,name = waiver(), breaks = waiver(), labels = waiver(), guide = waiver())</code></p>
<ul>
<li><code>trans</code> A formula or function of transformation from right to left.</li>
<li><code>name</code> The name/title of the secondary axis.</li>
<li><code>labels</code> A character vector giving labels (must be same length as <code>breaks</code>); or a function that takes the breaks as input and returns labels as output</li>
</ul>
<p><code>dup.axis(trans = ~.,name = waiver(), breaks = waiver(), labels = waiver(), guide = waiver())</code></p>
<p>is provide as a shorthand for creating a secondary axis that is a duplication of the primary axis, effectively mirroring the primary axis.</p>
<p><strong>dual axes rescale</strong></p>
<p>for dual axes, a major problem is to rescale the second axis so that two axes could be visualized normally.</p>
<p><a href="https://stackoverflow.com/questions/31953747/r-ggplot2-dual-y-axis-facet-wrap-one-histogram-and-other-line" class="uri">https://stackoverflow.com/questions/31953747/r-ggplot2-dual-y-axis-facet-wrap-one-histogram-and-other-line</a></p>
<p><code>scale_*_log10()</code>, <code>scale_*_sqrt()</code> and <code>scale_*_reverse()</code> are useful for axis transformation.</p>
<p>The principal components of every plot can be defined as follow:</p>
<ul>
<li><strong>data</strong> is a data frame</li>
<li><strong>Aesthetics</strong> is used to indicate x and y variables. It can also be used to control the <strong>color</strong>, the <strong>size</strong> or the <strong>shape</strong> of points, the height of bars, <strong>fill</strong> (“inside” color), <strong>linetype</strong>, etc…..</li>
<li><strong>Geometry</strong> defines the type of graphics (<strong>histogram</strong>, <strong>box plot</strong>, <strong>line plot</strong>, <strong>density plot</strong>, <strong>dot plot</strong>, ….)</li>
</ul>
<p>In most cases you start with <code>ggplot()</code>, supply a dataset and aesthetic mapping (with <code>aes()</code>). You then add on layers (like <code>geom_point()</code> or <code>geom_histogram()</code>), scales (like <code>scale_colour_brewer()</code>), faceting specifications (like <code>facet_wrap()</code>) and coordinate systems (like <code>coord_flip()</code>).</p>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="7.4-ggplot.html#cb523-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb523-2"><a href="7.4-ggplot.html#cb523-2" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> class)) <span class="sc">+</span>  <span class="co"># plot</span></span>
<span id="cb523-3"><a href="7.4-ggplot.html#cb523-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="co"># layer</span></span></code></pre></div>
<p><code>aes(x, y, ...)</code> function that sets aesthetic mappings. <code>aes()</code> can be specified either in plot or in layers.</p>
<ul>
<li><code>color</code> when in bar plot, <code>color</code> means for border, if you want to sepecify bar, you should use <code>fill</code></li>
</ul>
</div>
<div id="aes" class="section level3 hasAnchor" number="7.4.2">
<h3><span class="header-section-number">7.4.2</span> <code>aes()</code><a href="7.4-ggplot.html#aes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Aesthetic mappings <code>aes(x, y, ...)</code> describe how variables in the data are mapped to visual properties (aesthetics) of geoms. Aesthetic mappings can be set in <code>ggplot()</code> and in individual layers.</p>
<p><code>aes()</code> is a <a href="https://rlang.r-lib.org/reference/topic-defuse.html">quoting function</a>. This means that its inputs are quoted to be evaluated in the context of the data. This makes it easy to work with variables from the data frame because you can name those directly. The flip side is that you have to use <a href="https://rlang.r-lib.org/reference/topic-inject.html">quasiquotation</a> to program with <code>aes()</code>. See a tidy evaluation tutorial such as the <a href="https://dplyr.tidyverse.org/articles/programming.html">dplyr programming vignette</a> to learn more about these techniques.</p>
<p><strong>Specifying the aesthetics in the plot vs. in the layers</strong></p>
<p><a href="https://ggplot2-book.org/layers.html" class="uri">https://ggplot2-book.org/layers.html</a></p>
<p>If you only have <strong>one layer</strong> in the plot, the way you specify aesthetics <strong>doesn’t make any matter</strong>. However, <strong>the distinction is important when you start adding additional layers</strong>. These two plots are both valid and interesting, but focus on quite different aspects of the data:</p>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="7.4-ggplot.html#cb524-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> class)) <span class="sc">+</span> </span>
<span id="cb524-2"><a href="7.4-ggplot.html#cb524-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb524-3"><a href="7.4-ggplot.html#cb524-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>)</span>
<span id="cb524-4"><a href="7.4-ggplot.html#cb524-4" tabindex="-1"></a></span>
<span id="cb524-5"><a href="7.4-ggplot.html#cb524-5" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy)) <span class="sc">+</span> </span>
<span id="cb524-6"><a href="7.4-ggplot.html#cb524-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> class)) <span class="sc">+</span> </span>
<span id="cb524-7"><a href="7.4-ggplot.html#cb524-7" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="https://drive.google.com/thumbnail?id=1zzNj5_3r9toz5YudhpMq4gBGtjIAKRcI&sz=w1000" alt="aes" style="zoom:90%;" /></p>
<p>Not easy way to know the most correct method, only trial and error… 😌</p>
<p>Generally, you want to set up the mappings to illuminate the structure underlying the graphic and minimise typing. It may take some time before the best approach is immediately obvious, so if you’ve iterated your way to a complex graphic, it may be worthwhile to rewrite it to make the structure more clear.</p>
<p>Default method for <code>geom_smooth</code>: spline smoothing.</p>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="7.4-ggplot.html#cb525-1" tabindex="-1"></a><span class="fu">geom_smooth</span>(<span class="at">stat =</span> <span class="st">&#39;smooth&#39;</span>, <span class="at">color =</span> <span class="st">&#39;Red&#39;</span>, <span class="at">method =</span> <span class="st">&#39;gam&#39;</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">s</span>(x, <span class="at">bs =</span> <span class="st">&quot;cs&quot;</span>))</span></code></pre></div>
<p><strong>Setting vs. mapping</strong></p>
<p>Instead of mapping an aesthetic property to a variable, you can set it to a <em>single</em> value by specifying it in the layer parameters.</p>
<p>We</p>
<ul>
<li><p><strong>map</strong> an aesthetic to a variable (e.g., <code>aes(colour = cut)</code>) or</p>
<ul>
<li>mapping will generate each layer for every class in <code>cut</code></li>
</ul></li>
<li><p><strong>set</strong> it to a constant (e.g., <code>colour = "red"</code>). (See <code>par()</code> for a mapping list)</p>
<ul>
<li><p>assign values for aesthetics</p>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="7.4-ggplot.html#cb526-1" tabindex="-1"></a><span class="co"># specifying aesthetics inside `aes()` or outside is very different</span></span>
<span id="cb526-2"><a href="7.4-ggplot.html#cb526-2" tabindex="-1"></a></span>
<span id="cb526-3"><a href="7.4-ggplot.html#cb526-3" tabindex="-1"></a><span class="co"># outside `aes()`, passing aesthetic arguments by variable-value pairs</span></span>
<span id="cb526-4"><a href="7.4-ggplot.html#cb526-4" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(cty, hwy)) <span class="sc">+</span> </span>
<span id="cb526-5"><a href="7.4-ggplot.html#cb526-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">&quot;darkblue&quot;</span>) </span>
<span id="cb526-6"><a href="7.4-ggplot.html#cb526-6" tabindex="-1"></a></span>
<span id="cb526-7"><a href="7.4-ggplot.html#cb526-7" tabindex="-1"></a><span class="co"># inside `aes()`</span></span>
<span id="cb526-8"><a href="7.4-ggplot.html#cb526-8" tabindex="-1"></a><span class="co"># maps (not sets) the colour to the value ‘darkblue’. This effectively creates a new variable containing only the value ‘darkblue’ and then scales it with a colour scale. Because this value is discrete, the default colour scale uses evenly spaced colours on the colour wheel, and since there is only one value this colour is pinkish.</span></span>
<span id="cb526-9"><a href="7.4-ggplot.html#cb526-9" tabindex="-1"></a></span>
<span id="cb526-10"><a href="7.4-ggplot.html#cb526-10" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(cty, hwy)) <span class="sc">+</span> </span>
<span id="cb526-11"><a href="7.4-ggplot.html#cb526-11" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(cty, hwy)) <span class="sc">+</span> </span>
<span id="cb526-12"><a href="7.4-ggplot.html#cb526-12" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;darkblue&quot;</span>))</span></code></pre></div>
<div class="float">
<img src="/Users/menghan/Library/CloudStorage/Dropbox/coding_notes/figures/aes-2.png" alt="aes-2" />
<div class="figcaption">aes-2</div>
</div></li>
</ul>
<p>A third approach is to map the value, but override the default scale:</p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="7.4-ggplot.html#cb527-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(cty, hwy)) <span class="sc">+</span> </span>
<span id="cb527-2"><a href="7.4-ggplot.html#cb527-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;darkblue&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb527-3"><a href="7.4-ggplot.html#cb527-3" tabindex="-1"></a>  <span class="fu">scale_colour_identity</span>() <span class="co"># Use this set of scales when your data has already been scaled, i.e. it already represents aesthetic values that ggplot2 can handle directly. </span></span></code></pre></div>
<p>The functions <code>scale_colour_identity()</code>, <code>scale_fill_identity()</code>, <code>scale_size_identity()</code>, etc. work on the aesthetics specified in the scale name: <code>colour</code>, <code>fill</code>, <code>size</code>, etc. Use this set of scales when your data has already been scaled, i.e. it already represents aesthetic values that ggplot2 can handle directly. This is most useful if you always have a column that already contains colours.</p>
<ul>
<li><p>assign names for multiple layers</p>
<p>It’s sometimes useful to map aesthetics to constants. For example, if you want to display multiple layers with varying parameters, you can “name” each layer through “color/colour”:</p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="7.4-ggplot.html#cb528-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy)) <span class="sc">+</span> </span>
<span id="cb528-2"><a href="7.4-ggplot.html#cb528-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb528-3"><a href="7.4-ggplot.html#cb528-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;loess-name&quot;</span>), <span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="co"># a layer called &quot;loess-name&quot;, generating a colour scale named &quot;loess-name&quot;, not actually assigning colors to the series. Need to assign color through a color scale, ex. `scale_color_discrete()`.</span></span>
<span id="cb528-4"><a href="7.4-ggplot.html#cb528-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;lm-name&quot;</span>), <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="co"># a layer called &quot;lm-name&quot;</span></span></code></pre></div></li>
</ul></li>
</ul>
<p><code>aes()</code> also standardises aesthetic names by converting <code>color</code> to <code>colour</code> (also in substrings, e.g., point_color to point_colour) and translating old style R names to ggplot names (e.g., <code>pch</code> to <code>shape</code> and <code>cex</code> to <code>size</code>).</p>
<p><strong>Continuous scales for data (customize x &amp; y axis)</strong></p>
<p>Define your own axis preferences, breaks, limits, labels, …</p>
<p><code>scale_x_continuous()</code> and <code>scale_y_continuous()</code> are the default scales for continuous x and y aesthetics. There are three variants that set the <code>trans</code> argument for commonly used transformations: <code>scale_*_log10()</code>, <code>scale_*_sqrt()</code> and <code>scale_*_reverse()</code>.</p>
<p><code>scale_x_continuous(name = waiver(),breaks = waiver(),   minor_breaks = waiver(),n.breaks = NULL,labels = waiver(),   limits = NULL,expand = waiver(),oob = censor,   na.value = NA_real_, trans = "identity",   guide = waiver(),position = "bottom",   sec.axis = waiver() )</code></p>
<ul>
<li><span style="color:#008B45"><strong><code>limits</code> </strong></span>
<ul>
<li><code>NULL</code> to use the default scale range.</li>
<li>e.g., <code>c(0,1)</code> A numeric vector of length two providing limits of the scale. Use <code>NA</code> to refer to the existing minimum or maximum.</li>
<li>A function that accepts the existing (automatic) limits and returns new limits. Also accepts rlang <a href="https://rlang.r-lib.org/reference/as_function.html">lambda</a> function notation. Note that setting limits on positional scales will <strong>remove</strong> data outside of the limits.
<ul>
<li>If the purpose is to <strong>zoom</strong>, withouting clipping, use the limit argument in the coordinate system (see <code>coord_cartesian(xlim=c(0, 100), ylim=c(10, 20))</code>).</li>
</ul></li>
<li>alternatively, could use <code>+ xlim(0, 100) + ylim(10, 20)</code> to achieve the same effects. This is the same as <code>scale_x_continuous(limits=c(0, 100)) + scale_y_continuous(limits=c(10, 20))</code></li>
</ul></li>
<li><code>breaks</code>
<ul>
<li><code>NULL</code> for no breaks</li>
<li><code>waiver()</code> for the default breaks computed by the <a href="https://scales.r-lib.org/reference/trans_new.html">transformation object</a></li>
<li>A numeric vector of positions. Note that the vector will be cut off if the range exceeds the data coverage.</li>
<li>A function that takes the limits as input and returns breaks as output (e.g., a function returned by <code>scales::extended_breaks()</code>). Also accepts rlang <a href="https://rlang.r-lib.org/reference/as_function.html">lambda</a> function notation.</li>
</ul></li>
</ul>
<p>Other position scales: <code>scale_x_binned()</code>, <code>scale_x_date()</code>, <code>scale_x_discrete()</code>.</p>
<p><code>scale_x_date()</code> : class <code>Date</code></p>
<p><code>scale_x_datetime()</code> : class <code>POSIXct</code></p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="7.4-ggplot.html#cb529-1" tabindex="-1"></a><span class="fu">scale_x_datetime</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">date_format</span>(<span class="st">&quot;%Y&quot;</span>, <span class="at">tz =</span> <span class="st">&quot;CET&quot;</span>),</span>
<span id="cb529-2"><a href="7.4-ggplot.html#cb529-2" tabindex="-1"></a>                 <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fu">as.POSIXct</span>(<span class="st">&quot;1960-12-31 01:00:00 CET&quot;</span>),</span>
<span id="cb529-3"><a href="7.4-ggplot.html#cb529-3" tabindex="-1"></a>                              <span class="fu">as.POSIXct</span>(<span class="st">&quot;2015-02-11 01:00:00 CET&quot;</span>), <span class="st">&quot;10 years&quot;</span>)</span>
<span id="cb529-4"><a href="7.4-ggplot.html#cb529-4" tabindex="-1"></a>                 )</span></code></pre></div>
<ul>
<li><code>scales::date_format("%Y", tz = "CET")</code> is a wrapper for formatting dates on the axis.</li>
</ul>
<p><code>scale_x_time()</code> : class <code>hms</code></p>
<p><code>scale_(x|y)_binned()</code> are scales that discretize continuous position data. You can use these scales to transform continuous inputs before using it with a geom that requires discrete positions. An example is using <code>scale_x_binned()</code> with <code>geom_bar()</code> to create a histogram.</p>
<p><strong><code>scale_*_manual(..., values, breaks = waiver())</code></strong> specify your own set of mappings from levels in the data to aesthetic values.</p>
<ul>
<li><code>*</code> could be one of <strong><code>color</code>, <code>fill</code>, <code>size</code>, <code>shape</code>, <code>linetype</code>, <code>alpha</code>, <code>discrete</code> </strong>;
<ul>
<li>when using <code>discrete</code>, have to specify <code>aesthetics</code></li>
</ul></li>
</ul>
<p><code>scale_colour_manual(..., values, aesthetics = "colour", breaks = waiver())</code></p>
<ul>
<li><p><code>...</code> Arguments passed on to <code>discrete_scale</code>, which is a discrete scale constructor.</p>
<ul>
<li><code>palette</code> A palette function that when called with a single integer argument (the number of levels in the scale) returns the values that they should take.</li>
<li><code>limits</code> A character vector that defines possible values of the scale and their order</li>
<li><code>drop</code> Should unused factor levels be omitted from the scale? The default, <code>TRUE</code>, uses the levels that appear in the data; <code>FALSE</code> to keep all the levels in the factor.
<ul>
<li>often set to <code>drop=FALSE</code></li>
</ul></li>
<li><code>na.value</code> what aesthetic value should the missing values be displayed as? Useful to remove grey <code>NA</code> value area in figures.
<ul>
<li>often set to <strong><code>na.value = NA</code></strong></li>
</ul></li>
<li><strong><code>breaks</code></strong> A character vector of breaks</li>
<li><span style="color:orange"><strong><code>labels</code></strong></span> A character vector giving <strong>scale labels</strong> (must be same length as <code>breaks</code>)</li>
<li><code>guide</code> A function used to create <strong>a guide or its name</strong>.
<ul>
<li><span style="color:orange"><strong><code>guide = "legend"</code></strong></span> in <code>scale_*</code> is syntactic sugar for <code>guide = guide_legend()</code> (e.g. <code>scale_color_manual(guide = "legend")</code>). As for how to specify the guide for each scale in more detail, see <code>guides()</code>.</li>
<li>Guides can be specified in each <code>scale_*</code> or in <code>guides()</code>.</li>
</ul></li>
<li><code>name</code> <strong>The name of the scale</strong>. Used as the axis or legend title.</li>
</ul></li>
<li><p><code>values</code> a set of aesthetic values to map data values to. The values will be matched in order (usually <strong>alphabetical</strong>) with the limits of the scale, <strong>or with <code>breaks</code> if provided</strong>. If this is a <strong>named vector</strong>, then the values will be matched based on the names instead. Data values that don’t match will be given <code>na.value</code>.</p></li>
<li><p><code>aesthetics</code> Character string or vector of character strings listing the <strong>name(s) of the <span style="color:red">aesthetic(s)</span> that this scale works with</strong>. This can be useful, for example, to apply colour settings to the <code>colour</code> and <code>fill</code> aesthetics <strong>at the same time</strong>, via <code>aesthetics = c("colour", "fill")</code>.</p></li>
</ul>
<p><code>scale_fill_brewer(palette="Dark2")</code> use brewer color palettes.</p>
<p><code>scale_fill_grey()</code> Use grey scale</p>
<p><code>discrete_scale</code> Discrete Scale Constructor.</p>
<p><code>discrete_scale(aesthetics, scale_name, palette, name = NULL,  breaks = waiver(), labels = waiver(), legend = NULL, limits = NULL,  expand = waiver(), na.value = NA, drop = TRUE, guide = "legend")</code></p>
<p>common discrete scale parameters: <code>name</code>, <code>breaks</code>, <code>labels</code>, <code>na.value</code>, <code>limits</code> and <code>guide</code>.</p>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="7.4-ggplot.html#cb530-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(mpg, wt)) <span class="sc">+</span></span>
<span id="cb530-2"><a href="7.4-ggplot.html#cb530-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="fu">factor</span>(cyl)))</span>
<span id="cb530-3"><a href="7.4-ggplot.html#cb530-3" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>))</span>
<span id="cb530-4"><a href="7.4-ggplot.html#cb530-4" tabindex="-1"></a></span>
<span id="cb530-5"><a href="7.4-ggplot.html#cb530-5" tabindex="-1"></a><span class="co"># It&#39;s recommended to use a named vector</span></span>
<span id="cb530-6"><a href="7.4-ggplot.html#cb530-6" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;8&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>, <span class="st">&quot;4&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;6&quot;</span> <span class="ot">=</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;10&quot;</span> <span class="ot">=</span> <span class="st">&quot;orange&quot;</span>)</span>
<span id="cb530-7"><a href="7.4-ggplot.html#cb530-7" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> cols)</span>
<span id="cb530-8"><a href="7.4-ggplot.html#cb530-8" tabindex="-1"></a></span>
<span id="cb530-9"><a href="7.4-ggplot.html#cb530-9" tabindex="-1"></a><span class="co"># You can set color and fill aesthetics at the same time</span></span>
<span id="cb530-10"><a href="7.4-ggplot.html#cb530-10" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb530-11"><a href="7.4-ggplot.html#cb530-11" tabindex="-1"></a>  mtcars,</span>
<span id="cb530-12"><a href="7.4-ggplot.html#cb530-12" tabindex="-1"></a>  <span class="fu">aes</span>(mpg, wt, <span class="at">colour =</span> <span class="fu">factor</span>(cyl), <span class="at">fill =</span> <span class="fu">factor</span>(cyl))</span>
<span id="cb530-13"><a href="7.4-ggplot.html#cb530-13" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb530-14"><a href="7.4-ggplot.html#cb530-14" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb530-15"><a href="7.4-ggplot.html#cb530-15" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(</span>
<span id="cb530-16"><a href="7.4-ggplot.html#cb530-16" tabindex="-1"></a>    <span class="at">values =</span> cols,</span>
<span id="cb530-17"><a href="7.4-ggplot.html#cb530-17" tabindex="-1"></a>    <span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">&quot;colour&quot;</span>, <span class="st">&quot;fill&quot;</span>)</span>
<span id="cb530-18"><a href="7.4-ggplot.html#cb530-18" tabindex="-1"></a>  )</span>
<span id="cb530-19"><a href="7.4-ggplot.html#cb530-19" tabindex="-1"></a></span>
<span id="cb530-20"><a href="7.4-ggplot.html#cb530-20" tabindex="-1"></a><span class="co"># or you could just choose to plot a subset of category, ex. drop &quot;10&quot;</span></span>
<span id="cb530-21"><a href="7.4-ggplot.html#cb530-21" tabindex="-1"></a><span class="co"># As with other scales you can use breaks to control the appearance/order</span></span>
<span id="cb530-22"><a href="7.4-ggplot.html#cb530-22" tabindex="-1"></a><span class="co"># of the legend.</span></span>
<span id="cb530-23"><a href="7.4-ggplot.html#cb530-23" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_colour_manual</span>(</span>
<span id="cb530-24"><a href="7.4-ggplot.html#cb530-24" tabindex="-1"></a>  <span class="co"># name = &quot;Y series&quot;, # specify legend name here</span></span>
<span id="cb530-25"><a href="7.4-ggplot.html#cb530-25" tabindex="-1"></a>  <span class="at">values =</span> cols, </span>
<span id="cb530-26"><a href="7.4-ggplot.html#cb530-26" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;4&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;8&quot;</span>),</span>
<span id="cb530-27"><a href="7.4-ggplot.html#cb530-27" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;four&quot;</span>, <span class="st">&quot;six&quot;</span>, <span class="st">&quot;eight&quot;</span>)</span>
<span id="cb530-28"><a href="7.4-ggplot.html#cb530-28" tabindex="-1"></a>)</span>
<span id="cb530-29"><a href="7.4-ggplot.html#cb530-29" tabindex="-1"></a></span>
<span id="cb530-30"><a href="7.4-ggplot.html#cb530-30" tabindex="-1"></a></span>
<span id="cb530-31"><a href="7.4-ggplot.html#cb530-31" tabindex="-1"></a><span class="co"># And limits to control the possible values of the scale</span></span>
<span id="cb530-32"><a href="7.4-ggplot.html#cb530-32" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> cols, <span class="at">limits =</span> <span class="fu">c</span>(<span class="st">&quot;4&quot;</span>, <span class="st">&quot;8&quot;</span>))</span>
<span id="cb530-33"><a href="7.4-ggplot.html#cb530-33" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> cols, <span class="at">limits =</span> <span class="fu">c</span>(<span class="st">&quot;4&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;8&quot;</span>, <span class="st">&quot;10&quot;</span>))</span></code></pre></div>
<p><img src="https://drive.google.com/thumbnail?id=1Fn_xEBPcZX-kB2-DEgnAhWFhabsuN-c1&sz=w1000" alt="aes-3" style="zoom:40%;" /></p>
<p>Enlarge <code>geom_point()</code> dot size by setting <code>size=3</code>, default to 1.</p>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="7.4-ggplot.html#cb531-1" tabindex="-1"></a><span class="co"># Set aesthetics to fixed value</span></span>
<span id="cb531-2"><a href="7.4-ggplot.html#cb531-2" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(wt, mpg)) <span class="sc">+</span> </span>
<span id="cb531-3"><a href="7.4-ggplot.html#cb531-3" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="7.4-ggplot.html#cb532-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length), <span class="at">data =</span> iris) <span class="sc">+</span> </span>
<span id="cb532-2"><a href="7.4-ggplot.html#cb532-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">fill =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb532-3"><a href="7.4-ggplot.html#cb532-3" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept=</span><span class="fu">median</span>(iris<span class="sc">$</span>Sepal.Length),</span>
<span id="cb532-4"><a href="7.4-ggplot.html#cb532-4" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">&quot;median&quot;</span>), <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>,</span>
<span id="cb532-5"><a href="7.4-ggplot.html#cb532-5" tabindex="-1"></a>             <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb532-6"><a href="7.4-ggplot.html#cb532-6" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept=</span><span class="fu">mean</span>(iris<span class="sc">$</span>Sepal.Length),</span>
<span id="cb532-7"><a href="7.4-ggplot.html#cb532-7" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">&quot;mean&quot;</span>), <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>,</span>
<span id="cb532-8"><a href="7.4-ggplot.html#cb532-8" tabindex="-1"></a>             <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb532-9"><a href="7.4-ggplot.html#cb532-9" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">&quot;statistics&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="at">median =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">mean =</span> <span class="st">&quot;red&quot;</span>))</span></code></pre></div>
<p><img src="https://drive.google.com/thumbnail?id=1SCc7VsJ3vTwSxlR0_oWBv63jk4pbDHHv&sz=w1000" alt="aes-4" style="zoom:100%;" /></p>
<p><strong>Reference lines: horizontal, vertical, and diagonal</strong></p>
<p><code>geom_hline(slope, intercept)</code>, <code>geom_vline(xintercept)</code>, <code>geom_abline(yintercept)</code> add reference lines (sometimes called rules) to a plot, either horizontal, vertical, or diagonal (specified by slope and intercept).</p>
</div>
<div id="add-regression-line" class="section level3 hasAnchor" number="7.4.3">
<h3><span class="header-section-number">7.4.3</span> Add regression line<a href="7.4-ggplot.html#add-regression-line" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>geom_smooth(mapping = NULL,data = NULL,   stat = "smooth",position = "identity",   ...,   method = NULL,formula = NULL,se = TRUE,   na.rm = FALSE,orientation = NA,   show.legend = NA,inherit.aes = TRUE)</code></p>
<p>Addds a trend line over an existing plot. By default, it uses a <code>LOESS</code> smooth line. If you want a straight “linear model” line, you can use <code>method=lm</code>.</p>
<ul>
<li><p><code>method</code> Smoothing method (function) to use, accepts either <code>NULL</code> or a character vector, e.g. <span style="color:#008B45"><strong><code>"lm"</code></strong> (linear model)</span>, <code>"glm"</code>, <code>"gam"</code>, <code>"loess"</code> or a function, e.g. <code>MASS::rlm</code> or <code>mgcv::gam</code>, <code>stats::lm</code>, or <code>stats::loess</code>. <code>"auto"</code> is also accepted for backwards compatibility. It is equivalent to <code>NULL</code>.</p>
<p>Defaults to <code>loess</code> (Locally Estimated Scatterplot Smoothing) when there are fewer than 1000 observations, and a <code>gam</code> when there are more observations. loess method stands for local regression fitting.</p></li>
<li><p><code>formula</code> Formula to use in smoothing function, eg. <code>y ~ x</code>, <code>y ~ poly(x, 2)</code>, <code>y ~ log(x)</code>. <code>NULL</code> by default, in which case <code>method = NULL</code> implies <code>formula = y ~ x</code> when there are fewer than 1,000 observations and <code>formula = y ~ s(x, bs = "cs")</code> otherwise.</p></li>
<li><p><code>se=TRUE</code> Whether to show the uncertainty band.</p></li>
<li><p><code>level=.95</code> Level of confidence interval (CI) to use (0.95 by default).</p></li>
<li><p><code>color</code> color for the regression line</p></li>
<li><p><code>fill</code> color for the CI</p></li>
<li><p><code>alpha</code> transparency for the CI</p></li>
<li><p><code>show.legend</code> logical. Should this layer be included in the legends?</p>
<ul>
<li><code>NA</code>, the default, includes if any <strong>aesthetics are mapped</strong>. <code>FALSE</code> never includes, and</li>
<li><code>TRUE</code> always includes. It can also be a named logical vector to finely select the aesthetics to display.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="7.4-ggplot.html#cb533-1" tabindex="-1"></a><span class="co"># fit a linear regression</span></span>
<span id="cb533-2"><a href="7.4-ggplot.html#cb533-2" tabindex="-1"></a><span class="fu">geom_smooth</span>(<span class="at">data=</span><span class="fu">subset</span>(long_format,key<span class="sc">==</span><span class="st">&quot;values_ma&quot;</span>),</span>
<span id="cb533-3"><a href="7.4-ggplot.html#cb533-3" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color=</span><span class="st">&#39;lm1&#39;</span>, <span class="at">linetype=</span><span class="st">&#39;lm1&#39;</span>, <span class="at">size=</span><span class="st">&#39;lm1&#39;</span>), <span class="at">method=</span>lm, <span class="at">se=</span><span class="cn">FALSE</span>) </span>
<span id="cb533-4"><a href="7.4-ggplot.html#cb533-4" tabindex="-1"></a></span>
<span id="cb533-5"><a href="7.4-ggplot.html#cb533-5" tabindex="-1"></a><span class="co"># fit a quadratic function</span></span>
<span id="cb533-6"><a href="7.4-ggplot.html#cb533-6" tabindex="-1"></a><span class="fu">ggplot</span>(CEF, <span class="fu">aes</span>(<span class="at">x=</span>engine.size, <span class="at">y=</span>mean_city.distance)) <span class="sc">+</span></span>
<span id="cb533-7"><a href="7.4-ggplot.html#cb533-7" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb533-8"><a href="7.4-ggplot.html#cb533-8" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&#39;lm&#39;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb533-9"><a href="7.4-ggplot.html#cb533-9" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.5</span>)),</span>
<span id="cb533-10"><a href="7.4-ggplot.html#cb533-10" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.5</span>)))</span>
<span id="cb533-11"><a href="7.4-ggplot.html#cb533-11" tabindex="-1"></a><span class="co"># fit a degree 3 polynomial regression</span></span>
<span id="cb533-12"><a href="7.4-ggplot.html#cb533-12" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">3</span>), <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><strong>Add regression equation to scatter plot</strong></p>
<p><code>ggpubr::stat_regline_equation(label.y=NULL)</code></p>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="7.4-ggplot.html#cb534-1" tabindex="-1"></a><span class="fu">library</span>(ggpubr) <span class="co"># add regression eq to figure</span></span>
<span id="cb534-2"><a href="7.4-ggplot.html#cb534-2" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes_string</span>(<span class="at">x=</span><span class="st">&quot;true value&quot;</span>, <span class="at">y=</span><span class="st">&#39;predicted value&#39;</span>)) <span class="sc">+</span></span>
<span id="cb534-3"><a href="7.4-ggplot.html#cb534-3" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">shape=</span><span class="dv">1</span>) <span class="sc">+</span>    <span class="co"># Use hollow circles, default solid dot</span></span>
<span id="cb534-4"><a href="7.4-ggplot.html#cb534-4" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span><span class="fu">ifelse</span>(Model <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;GFDL-ESM4&#39;</span>, <span class="st">&#39;MIROC6&#39;</span>), <span class="fu">as.character</span>(Model),<span class="st">&#39;&#39;</span>)), <span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.05</span>, <span class="at">vjust=</span><span class="dv">0</span>, <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span> <span class="co"># add text to outliers</span></span>
<span id="cb534-5"><a href="7.4-ggplot.html#cb534-5" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">subtitle=</span><span class="st">&quot;predicted v.s. true values&quot;</span>, <span class="at">x=</span><span class="st">&#39;Simple global TCS [K]&#39;</span>, <span class="at">y=</span><span class="st">&#39;Converted global TCS [K]&#39;</span>) <span class="sc">+</span></span>
<span id="cb534-6"><a href="7.4-ggplot.html#cb534-6" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm, <span class="at">se=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb534-7"><a href="7.4-ggplot.html#cb534-7" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">intercept=</span><span class="dv">0</span>, <span class="at">slope=</span><span class="dv">1</span>, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">color=</span><span class="st">&#39;red&#39;</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb534-8"><a href="7.4-ggplot.html#cb534-8" tabindex="-1"></a>    <span class="fu">stat_regline_equation</span>(<span class="at">label.y=</span><span class="fl">3.3</span>) <span class="sc">+</span> <span class="co"># add regression equation</span></span>
<span id="cb534-9"><a href="7.4-ggplot.html#cb534-9" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><code>geom_text(data, mapping, check_overlap = FALSE, ...)</code> add text to the plot</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="7.4-ggplot.html#cb535-1" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(wt, mpg)) <span class="sc">+</span></span>
<span id="cb535-2"><a href="7.4-ggplot.html#cb535-2" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">rownames</span>(mtcars)))</span></code></pre></div>
<p><strong><code>ggrepel::geom_text_repel(aes(label=Model), size=3.5, fontface="bold")</code></strong> avoid overlap among labels.</p>
<p><code>geom_label()</code> works similar to <code>geom_text</code>, except for that text is wrapped in a box.</p>
<p>Q: How to remove ‘a’ from legend when using aesthetics and <code>geom_text</code>?</p>
<p>A: Set <code>show.legend = FALSE</code> in <code>geom_text</code>.</p>
<p><strong>legends</strong> for <code>geom_text</code> can only be called via <code>color</code>. If <code>color</code> is used before, then in order to keep the current color scheme, we have to add a new color scale, using <code>ggnewscale::new_scale_color()+</code> and carrying on what you have to do afterwards.</p>
<p><a href="https://stackoverflow.com/questions/59091627/add-new-legend-for-geom-text-with-text-labels-as-legend-key" class="uri">https://stackoverflow.com/questions/59091627/add-new-legend-for-geom-text-with-text-labels-as-legend-key</a></p>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="7.4-ggplot.html#cb536-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb536-2"><a href="7.4-ggplot.html#cb536-2" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb536-3"><a href="7.4-ggplot.html#cb536-3" tabindex="-1"></a><span class="fu">library</span>(ggnewscale)</span>
<span id="cb536-4"><a href="7.4-ggplot.html#cb536-4" tabindex="-1"></a></span>
<span id="cb536-5"><a href="7.4-ggplot.html#cb536-5" tabindex="-1"></a>pfda_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>pfdavar,<span class="fu">aes</span>(<span class="at">x=</span>X1,<span class="at">y=</span>X2,<span class="at">group=</span>groups))<span class="sc">+</span></span>
<span id="cb536-6"><a href="7.4-ggplot.html#cb536-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour=</span>groups))<span class="sc">+</span></span>
<span id="cb536-7"><a href="7.4-ggplot.html#cb536-7" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data=</span>hulls,<span class="at">alpha=</span><span class="fl">0.2</span>,<span class="fu">aes</span>(<span class="at">fill=</span>groups))<span class="sc">+</span></span>
<span id="cb536-8"><a href="7.4-ggplot.html#cb536-8" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;pFDA1&quot;</span>)<span class="sc">+</span></span>
<span id="cb536-9"><a href="7.4-ggplot.html#cb536-9" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;pFDA2&quot;</span>)<span class="sc">+</span></span>
<span id="cb536-10"><a href="7.4-ggplot.html#cb536-10" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb536-11"><a href="7.4-ggplot.html#cb536-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb536-12"><a href="7.4-ggplot.html#cb536-12" tabindex="-1"></a>  <span class="fu">new_scale_color</span>()<span class="sc">+</span>   <span class="co"># define a ne color scheme</span></span>
<span id="cb536-13"><a href="7.4-ggplot.html#cb536-13" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>labels,<span class="at">col=</span>Species),</span>
<span id="cb536-14"><a href="7.4-ggplot.html#cb536-14" tabindex="-1"></a>  <span class="at">fontface=</span><span class="dv">1</span>,<span class="at">hjust=</span><span class="dv">0</span>,<span class="at">vjust=</span><span class="dv">0</span>,<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb536-15"><a href="7.4-ggplot.html#cb536-15" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">rep</span>(<span class="st">&quot;black&quot;</span>,<span class="dv">18</span>))</span></code></pre></div>
<p>The above gives you something close, just that it is all ‘a’ for geom_text legend. What we need to do now, is change the default ‘a’, and for this I used <a href="https://stackoverflow.com/questions/49965758/change-geom-texts-default-a-legend-to-label-string-itself">@MarcoSandri’s solution to change the default “a” in legend for geom_text()</a></p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="7.4-ggplot.html#cb537-1" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplotGrob</span>(pfda_plot)</span>
<span id="cb537-2"><a href="7.4-ggplot.html#cb537-2" tabindex="-1"></a>lbls <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">18</span></span>
<span id="cb537-3"><a href="7.4-ggplot.html#cb537-3" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">sapply</span>(g<span class="sc">$</span>grobs[[<span class="dv">15</span>]][[<span class="dv">1</span>]][[<span class="dv">1</span>]]<span class="sc">$</span>grobs,<span class="cf">function</span>(i){</span>
<span id="cb537-4"><a href="7.4-ggplot.html#cb537-4" tabindex="-1"></a>  <span class="st">&quot;label&quot;</span> <span class="sc">%in%</span> <span class="fu">names</span>(i)}))</span>
<span id="cb537-5"><a href="7.4-ggplot.html#cb537-5" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(idx)){</span>
<span id="cb537-6"><a href="7.4-ggplot.html#cb537-6" tabindex="-1"></a>g<span class="sc">$</span>grobs[[<span class="dv">15</span>]][[<span class="dv">1</span>]][[<span class="dv">1</span>]]<span class="sc">$</span>grobs[[idx[i]]]<span class="sc">$</span>label <span class="ot">&lt;-</span> lbls[i]</span>
<span id="cb537-7"><a href="7.4-ggplot.html#cb537-7" tabindex="-1"></a>}</span>
<span id="cb537-8"><a href="7.4-ggplot.html#cb537-8" tabindex="-1"></a><span class="fu">grid.draw</span>(g)</span></code></pre></div>
<p><img src="https://drive.google.com/thumbnail?id=1AbBPG9AeA6g4GnlenpGy1KOuq1sGI9bh&sz=w1000" alt="legend-1" style="zoom:30%;" /></p>
<p><code>geom(text)</code></p>
<p>With <code>geom_text</code> or <code>annotate</code> in ggplot2, you can set a number of properties of the text. <code>geom_text</code> is used to add text from the data frame, and <code>annotate</code> is used to add a single text element.</p>
<table>
<thead>
<tr class="header">
<th align="left">Name</th>
<th align="left">Default value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>size</code></td>
<td align="left">5</td>
</tr>
<tr class="even">
<td align="left"><code>family</code></td>
<td align="left"><code>""</code> (sans)</td>
</tr>
<tr class="odd">
<td align="left"><code>fontface</code></td>
<td align="left"><code>plain</code></td>
</tr>
<tr class="even">
<td align="left"><code>lineheight</code></td>
<td align="left">1.2</td>
</tr>
<tr class="odd">
<td align="left"><code>angle</code></td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left"><code>hjust</code></td>
<td align="left">0.5</td>
</tr>
<tr class="odd">
<td align="left"><code>vjust</code></td>
<td align="left">0.5</td>
</tr>
</tbody>
</table>
<hr />
</div>
<div id="subplots" class="section level3 hasAnchor" number="7.4.4">
<h3><span class="header-section-number">7.4.4</span> Subplots<a href="7.4-ggplot.html#subplots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Note that the <strong>group</strong> must be called in the <strong><code>X</code> </strong>argument of <code>ggplot(aes(x = group, fill = subgroup))</code>.</p>
<p>The <strong>subgroup</strong> is called in the <strong><code>fill</code></strong> argument.</p>
<p>The <code>facet_wrap(~class, nrow = NULL,</code>
<code>ncol = NULL, scales = "fixed")</code> ( Multiple plots by factor in ggplot (facets) ) gives out each variable in an individual panel grouped by <code>class</code>. <code>~class</code> can also be <code>vars(class)</code>.</p>
<ul>
<li><code>facet_grid()</code> function will produce a grid of plots for each combination of variables that you specify, even if some plots are empty.</li>
<li><code>scales='fixed'</code> if subplots share x-axes or y-axes; <span style="color:#008B45"><code>scales='free'</code></span> for each plot having its own axes.</li>
<li><code>nrow</code>, <code>ncol</code> define #of rows/cols</li>
</ul>
<p><code>geom_errorbar()</code> A <a href="http://sape.inf.usi.ch/quick-reference/ggplot2/geom">geom</a> that draws error bars, defined by an upper and lower value. This is useful e.g., to draw confidence intervals.</p>
</div>
<div id="parameters-1" class="section level3 hasAnchor" number="7.4.5">
<h3><span class="header-section-number">7.4.5</span> Parameters<a href="7.4-ggplot.html#parameters-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>x</strong> - (required) x coordinate of the bar</li>
<li><strong>ymin</strong> - (required) y coordinate of the lower whisker</li>
<li><strong>ymax</strong> - (required) y coordinate of the upper whisker</li>
<li><a href="http://sape.inf.usi.ch/quick-reference/ggplot2/size">size</a> - (default: 0.5) thickness of the lines</li>
<li><a href="http://sape.inf.usi.ch/quick-reference/ggplot2/linetype">linetype</a> - (default: 1=solid) the type of the lines</li>
<li>colour - (default: “black”) the color of the lines</li>
<li>width - (default: 0.9) width of the whiskers</li>
<li><a href="http://sape.inf.usi.ch/quick-reference/ggplot2/alpha">alpha</a> - (default: 1=opaque) the transparency of the lines</li>
</ul>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="7.4-ggplot.html#cb538-1" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span>  Rad_trend_decade_allCON <span class="sc">%&gt;%</span> </span>
<span id="cb538-2"><a href="7.4-ggplot.html#cb538-2" tabindex="-1"></a>    <span class="fu">gather</span>(seasons, values, <span class="sc">-</span>CON) <span class="sc">%&gt;%</span> </span>
<span id="cb538-3"><a href="7.4-ggplot.html#cb538-3" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">seasons =</span> <span class="fu">factor</span>(seasons, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;DJF&quot;</span>, <span class="st">&quot;MAM&quot;</span>, <span class="st">&quot;JJA&quot;</span>, <span class="st">&quot;SON&quot;</span>, <span class="st">&quot;ANN&quot;</span>) ),</span>
<span id="cb538-4"><a href="7.4-ggplot.html#cb538-4" tabindex="-1"></a>           <span class="at">CON =</span> <span class="fu">factor</span>(CON, <span class="at">levels=</span><span class="fu">c</span>(CON_levels, <span class="st">&quot;WD&quot;</span>) ) </span>
<span id="cb538-5"><a href="7.4-ggplot.html#cb538-5" tabindex="-1"></a>          )</span>
<span id="cb538-6"><a href="7.4-ggplot.html#cb538-6" tabindex="-1"></a>plot_data</span>
<span id="cb538-7"><a href="7.4-ggplot.html#cb538-7" tabindex="-1"></a></span>
<span id="cb538-8"><a href="7.4-ggplot.html#cb538-8" tabindex="-1"></a></span>
<span id="cb538-9"><a href="7.4-ggplot.html#cb538-9" tabindex="-1"></a><span class="do">## group by season</span></span>
<span id="cb538-10"><a href="7.4-ggplot.html#cb538-10" tabindex="-1"></a>p_season_box <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x=</span>CON, <span class="at">y=</span>values, <span class="at">fill=</span>CON) ) <span class="sc">+</span></span>
<span id="cb538-11"><a href="7.4-ggplot.html#cb538-11" tabindex="-1"></a>    <span class="fu">stat_boxplot</span>(<span class="at">geom =</span><span class="st">&#39;errorbar&#39;</span>,</span>
<span id="cb538-12"><a href="7.4-ggplot.html#cb538-12" tabindex="-1"></a>                 <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)</span>
<span id="cb538-13"><a href="7.4-ggplot.html#cb538-13" tabindex="-1"></a>                ) <span class="sc">+</span></span>
<span id="cb538-14"><a href="7.4-ggplot.html#cb538-14" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>,</span>
<span id="cb538-15"><a href="7.4-ggplot.html#cb538-15" tabindex="-1"></a>                 <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)</span>
<span id="cb538-16"><a href="7.4-ggplot.html#cb538-16" tabindex="-1"></a>                ) <span class="sc">+</span></span>
<span id="cb538-17"><a href="7.4-ggplot.html#cb538-17" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">7</span>, <span class="dv">7</span>), <span class="co"># set limits of y-axis</span></span>
<span id="cb538-18"><a href="7.4-ggplot.html#cb538-18" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">7</span>, <span class="dv">7</span>, <span class="at">by=</span><span class="dv">2</span>)</span>
<span id="cb538-19"><a href="7.4-ggplot.html#cb538-19" tabindex="-1"></a>                      ) <span class="sc">+</span> </span>
<span id="cb538-20"><a href="7.4-ggplot.html#cb538-20" tabindex="-1"></a>        <span class="fu">facet_wrap</span>(<span class="sc">~</span>seasons, <span class="at">nrow=</span><span class="dv">1</span>)</span>
<span id="cb538-21"><a href="7.4-ggplot.html#cb538-21" tabindex="-1"></a></span>
<span id="cb538-22"><a href="7.4-ggplot.html#cb538-22" tabindex="-1"></a>p_season_box </span></code></pre></div>
<p><strong>Ignore outliers</strong></p>
<p>Sometimes it can be useful to hide the outliers, for example when overlaying the raw data points on top of the boxplot. Hiding the outliers can be achieved by setting <code>outlier.shape = NA</code>. But the outliers would still affect the y-axis scale and make your box condensed. You need to set <code>outliers = FALSE</code> too.</p>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="7.4-ggplot.html#cb539-1" tabindex="-1"></a><span class="co"># set y-axis limits mannually</span></span>
<span id="cb539-2"><a href="7.4-ggplot.html#cb539-2" tabindex="-1"></a><span class="fu">ggplot</span>(the_variable, <span class="fu">aes</span>(<span class="at">x=</span>Water_receive, <span class="at">y=</span>water_stress, <span class="at">fill=</span>year)) <span class="sc">+</span></span>
<span id="cb539-3"><a href="7.4-ggplot.html#cb539-3" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb539-4"><a href="7.4-ggplot.html#cb539-4" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">quantile</span>(the_variable<span class="sc">$</span>water_stress, <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>)))</span>
<span id="cb539-5"><a href="7.4-ggplot.html#cb539-5" tabindex="-1"></a></span>
<span id="cb539-6"><a href="7.4-ggplot.html#cb539-6" tabindex="-1"></a><span class="co"># set outliers = FALSE by discarding outliers from the plot</span></span>
<span id="cb539-7"><a href="7.4-ggplot.html#cb539-7" tabindex="-1"></a><span class="fu">ggplot</span>(the_variable, <span class="fu">aes</span>(<span class="at">x=</span>Water_receive, <span class="at">y=</span>water_stress, <span class="at">fill=</span>year)) <span class="sc">+</span></span>
<span id="cb539-8"><a href="7.4-ggplot.html#cb539-8" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">outliers =</span> <span class="cn">FALSE</span>) </span></code></pre></div>
<p>Deal with Outliers</p>
<p>One idea would be to <a href="http://en.wikipedia.org/wiki/Winsorising"><em>winsorize</em></a> the data in a two-pass procedure:</p>
<ol style="list-style-type: decimal">
<li>run a first pass, learn what the bounds are, e.g. cut of at given percentile, or N standard deviation above the mean, or …</li>
<li>in a second pass, set the values beyond the given bound to the value of that bound</li>
</ol>
<p>I should stress that this is an <em>old-fashioned</em> method which ought to be dominated by more <em>modern robust techniques</em> but you still come across it a lot.</p>
<p><strong>Grouped bar plot</strong></p>
<p>The items on the x-axis have x values of 1, 2, 3, and so on, though you typically don’t refer to them by these numerical values.</p>
<ul>
<li>When you use <code>geom_bar(width = 0.9)</code>, it makes each group take up a total width of 0.9 on the x-axis. 组间宽度。</li>
<li>When you use <code>position_dodge(width = 0.9)</code>, it spaces the bars so that the <em>middle</em> of each bar is right where it would be if the bar width were 0.9 and the bars were touching. 值越大，同一组的bar之间越远。组内bar之间的间距。</li>
</ul>
<p>Another option is to calculate <code>stats</code> first, and plot <code>geom_crossbar</code>. It is much faster this way.</p>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="7.4-ggplot.html#cb540-1" tabindex="-1"></a>Rad_trend_decade_group <span class="ot">&lt;-</span> Rad_trend_decade_allCON <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(CON)</span>
<span id="cb540-2"><a href="7.4-ggplot.html#cb540-2" tabindex="-1"></a>groups <span class="ot">&lt;-</span> Rad_trend_decade_group <span class="sc">%&gt;%</span> </span>
<span id="cb540-3"><a href="7.4-ggplot.html#cb540-3" tabindex="-1"></a>    <span class="fu">group_split</span>()</span>
<span id="cb540-4"><a href="7.4-ggplot.html#cb540-4" tabindex="-1"></a><span class="fu">group_keys</span>(Rad_trend_decade_group)</span>
<span id="cb540-5"><a href="7.4-ggplot.html#cb540-5" tabindex="-1"></a></span>
<span id="cb540-6"><a href="7.4-ggplot.html#cb540-6" tabindex="-1"></a>groups[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>CON) <span class="sc">%&gt;%</span> <span class="fu">apply</span>(<span class="dv">2</span>, <span class="cf">function</span>(group) <span class="fu">boxplot.stats</span>(group)<span class="sc">$</span>stats)</span>
<span id="cb540-7"><a href="7.4-ggplot.html#cb540-7" tabindex="-1"></a></span>
<span id="cb540-8"><a href="7.4-ggplot.html#cb540-8" tabindex="-1"></a>trend_summary_tibble <span class="ot">&lt;-</span> Rad_trend_decade_group <span class="sc">%&gt;%</span> </span>
<span id="cb540-9"><a href="7.4-ggplot.html#cb540-9" tabindex="-1"></a>    <span class="fu">group_modify</span>(<span class="sc">~</span>{</span>
<span id="cb540-10"><a href="7.4-ggplot.html#cb540-10" tabindex="-1"></a>        .x <span class="sc">%&gt;%</span> </span>
<span id="cb540-11"><a href="7.4-ggplot.html#cb540-11" tabindex="-1"></a>            <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">&quot;DJF&quot;</span>, <span class="st">&quot;MAM&quot;</span>, <span class="st">&quot;JJA&quot;</span>, <span class="st">&quot;SON&quot;</span>, <span class="st">&quot;ANN&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb540-12"><a href="7.4-ggplot.html#cb540-12" tabindex="-1"></a>            <span class="fu">apply</span>(<span class="dv">2</span>, <span class="cf">function</span>(group) </span>
<span id="cb540-13"><a href="7.4-ggplot.html#cb540-13" tabindex="-1"></a>                <span class="fu">boxplot.stats</span>(group)<span class="sc">$</span>stats) <span class="sc">%&gt;%</span> </span>
<span id="cb540-14"><a href="7.4-ggplot.html#cb540-14" tabindex="-1"></a>            <span class="fu">as_tibble</span>()</span>
<span id="cb540-15"><a href="7.4-ggplot.html#cb540-15" tabindex="-1"></a>    }) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span>
<span id="cb540-16"><a href="7.4-ggplot.html#cb540-16" tabindex="-1"></a>trend_summary_tibble <span class="ot">&lt;-</span> trend_summary_tibble <span class="sc">%&gt;%</span> </span>
<span id="cb540-17"><a href="7.4-ggplot.html#cb540-17" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">stats =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;low.whisker&quot;</span>, <span class="st">&quot;1st.Q&quot;</span>, <span class="st">&quot;median&quot;</span>, <span class="st">&quot;3rd.Q&quot;</span>, <span class="st">&quot;upper.whisker&quot;</span>), <span class="dv">7</span> ) )</span>
<span id="cb540-18"><a href="7.4-ggplot.html#cb540-18" tabindex="-1"></a>trend_summary_tibble</span>
<span id="cb540-19"><a href="7.4-ggplot.html#cb540-19" tabindex="-1"></a><span class="co"># A tibble: 35 x 7</span></span>
<span id="cb540-20"><a href="7.4-ggplot.html#cb540-20" tabindex="-1"></a><span class="co"># CON      DJF    MAM     JJA    SON    ANN stats        </span></span>
<span id="cb540-21"><a href="7.4-ggplot.html#cb540-21" tabindex="-1"></a><span class="co"># &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;        </span></span>
<span id="cb540-22"><a href="7.4-ggplot.html#cb540-22" tabindex="-1"></a><span class="co"># 1 AF    -1.43  -1.44  -2.43   -1.29  -0.768 low.whisker  </span></span>
<span id="cb540-23"><a href="7.4-ggplot.html#cb540-23" tabindex="-1"></a><span class="co"># 2 AF     0.428  0.506 -0.160   0.423  0.543 1st.Q        </span></span>
<span id="cb540-24"><a href="7.4-ggplot.html#cb540-24" tabindex="-1"></a><span class="co"># 3 AF     1.02   1.11   0.393   0.966  0.988 median       </span></span>
<span id="cb540-25"><a href="7.4-ggplot.html#cb540-25" tabindex="-1"></a><span class="co"># 4 AF     1.68   1.84   1.41    1.58   1.42  3rd.Q        </span></span>
<span id="cb540-26"><a href="7.4-ggplot.html#cb540-26" tabindex="-1"></a><span class="co"># 5 AF     3.54   3.84   3.77    3.32   2.73  upper.whisker</span></span>
<span id="cb540-27"><a href="7.4-ggplot.html#cb540-27" tabindex="-1"></a><span class="co"># 6 AS    -1.72  -4.17  -6.84   -3.45  -2.96  low.whisker  </span></span>
<span id="cb540-28"><a href="7.4-ggplot.html#cb540-28" tabindex="-1"></a><span class="co"># 7 AS    -0.282 -0.774 -1.65   -0.974 -0.652 1st.Q        </span></span>
<span id="cb540-29"><a href="7.4-ggplot.html#cb540-29" tabindex="-1"></a><span class="co"># 8 AS     0.192  0.296  0.0631 -0.116  0.168 median       </span></span>
<span id="cb540-30"><a href="7.4-ggplot.html#cb540-30" tabindex="-1"></a><span class="co"># 9 AS     0.673  1.49   1.81    0.674  0.888 3rd.Q        </span></span>
<span id="cb540-31"><a href="7.4-ggplot.html#cb540-31" tabindex="-1"></a><span class="co"># 10 AS     2.11   4.89   7.00    3.15   3.18  upper.whisker</span></span>
<span id="cb540-32"><a href="7.4-ggplot.html#cb540-32" tabindex="-1"></a></span>
<span id="cb540-33"><a href="7.4-ggplot.html#cb540-33" tabindex="-1"></a>CON_levels <span class="ot">&lt;-</span> trend_summary_tibble <span class="sc">%&gt;%</span> </span>
<span id="cb540-34"><a href="7.4-ggplot.html#cb540-34" tabindex="-1"></a>    <span class="fu">filter</span>((stats<span class="sc">==</span><span class="st">&quot;median&quot;</span>) <span class="sc">&amp;</span>(CON<span class="sc">!=</span><span class="st">&quot;WD&quot;</span>) ) <span class="sc">%&gt;%</span> </span>
<span id="cb540-35"><a href="7.4-ggplot.html#cb540-35" tabindex="-1"></a>    <span class="fu">arrange</span>(ANN) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(CON)</span>
<span id="cb540-36"><a href="7.4-ggplot.html#cb540-36" tabindex="-1"></a>CON_levels</span>
<span id="cb540-37"><a href="7.4-ggplot.html#cb540-37" tabindex="-1"></a></span>
<span id="cb540-38"><a href="7.4-ggplot.html#cb540-38" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> trend_summary_tibble <span class="sc">%&gt;%</span> </span>
<span id="cb540-39"><a href="7.4-ggplot.html#cb540-39" tabindex="-1"></a>    <span class="fu">gather</span>(seasons, values, <span class="sc">-</span>CON, <span class="sc">-</span>stats) <span class="sc">%&gt;%</span> </span>
<span id="cb540-40"><a href="7.4-ggplot.html#cb540-40" tabindex="-1"></a>    <span class="fu">spread</span>(stats, values)</span>
<span id="cb540-41"><a href="7.4-ggplot.html#cb540-41" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> plot_data <span class="sc">%&gt;%</span> </span>
<span id="cb540-42"><a href="7.4-ggplot.html#cb540-42" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">seasons =</span> <span class="fu">factor</span>(seasons, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;DJF&quot;</span>, <span class="st">&quot;MAM&quot;</span>, <span class="st">&quot;JJA&quot;</span>, <span class="st">&quot;SON&quot;</span>, <span class="st">&quot;ANN&quot;</span>) ),</span>
<span id="cb540-43"><a href="7.4-ggplot.html#cb540-43" tabindex="-1"></a>           <span class="at">CON =</span> <span class="fu">factor</span>(CON, <span class="at">levels=</span><span class="fu">c</span>(CON_levels, <span class="st">&quot;WD&quot;</span>) )</span>
<span id="cb540-44"><a href="7.4-ggplot.html#cb540-44" tabindex="-1"></a>    )</span>
<span id="cb540-45"><a href="7.4-ggplot.html#cb540-45" tabindex="-1"></a>plot_data</span>
<span id="cb540-46"><a href="7.4-ggplot.html#cb540-46" tabindex="-1"></a><span class="co"># A tibble: 9,072,000 x 3</span></span>
<span id="cb540-47"><a href="7.4-ggplot.html#cb540-47" tabindex="-1"></a><span class="co">#  CON   seasons   values</span></span>
<span id="cb540-48"><a href="7.4-ggplot.html#cb540-48" tabindex="-1"></a><span class="co"># &lt;fct&gt;   &lt;fct&gt;     &lt;dbl&gt;</span></span>
<span id="cb540-49"><a href="7.4-ggplot.html#cb540-49" tabindex="-1"></a><span class="co"># 1 EU    DJF         NA</span></span>
<span id="cb540-50"><a href="7.4-ggplot.html#cb540-50" tabindex="-1"></a><span class="co"># 2 EU    DJF         NA</span></span>
<span id="cb540-51"><a href="7.4-ggplot.html#cb540-51" tabindex="-1"></a><span class="co"># 3 EU    DJF         NA</span></span>
<span id="cb540-52"><a href="7.4-ggplot.html#cb540-52" tabindex="-1"></a><span class="co"># 4 EU    DJF         NA</span></span>
<span id="cb540-53"><a href="7.4-ggplot.html#cb540-53" tabindex="-1"></a><span class="co"># 5 EU    DJF         NA      </span></span>
<span id="cb540-54"><a href="7.4-ggplot.html#cb540-54" tabindex="-1"></a>      </span>
<span id="cb540-55"><a href="7.4-ggplot.html#cb540-55" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb540-56"><a href="7.4-ggplot.html#cb540-56" tabindex="-1"></a>dodge <span class="ot">&lt;-</span> <span class="fu">position_dodge</span>(<span class="at">width=</span><span class="fl">0.9</span>)</span>
<span id="cb540-57"><a href="7.4-ggplot.html#cb540-57" tabindex="-1"></a><span class="do">## Group by continent</span></span>
<span id="cb540-58"><a href="7.4-ggplot.html#cb540-58" tabindex="-1"></a><span class="co"># dev.set(dev.prev())</span></span>
<span id="cb540-59"><a href="7.4-ggplot.html#cb540-59" tabindex="-1"></a>p_box <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x=</span>seasons, <span class="at">y=</span>median, <span class="at">fill =</span> seasons) ) <span class="sc">+</span></span>
<span id="cb540-60"><a href="7.4-ggplot.html#cb540-60" tabindex="-1"></a>    <span class="fu">geom_crossbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> <span class="st">`</span><span class="at">1st.Q</span><span class="st">`</span>, <span class="at">ymax =</span> <span class="st">`</span><span class="at">3rd.Q</span><span class="st">`</span>), <span class="at">width =</span> <span class="fl">0.8</span>, <span class="at">size=</span><span class="fl">0.35</span>, <span class="at">position =</span> dodge) <span class="sc">+</span></span>
<span id="cb540-61"><a href="7.4-ggplot.html#cb540-61" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> low.whisker, <span class="at">ymax =</span> upper.whisker, ), <span class="at">width =</span> <span class="fl">0.8</span>, <span class="at">position =</span> dodge) <span class="sc">+</span> </span>
<span id="cb540-62"><a href="7.4-ggplot.html#cb540-62" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>CON, <span class="at">nrow=</span><span class="dv">1</span>) <span class="sc">+</span> <span class="co"># subplots group by &#39;CON&#39;</span></span>
<span id="cb540-63"><a href="7.4-ggplot.html#cb540-63" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y=</span><span class="fu">TeX</span>(<span class="st">&quot;SSR Trend </span><span class="sc">\\</span><span class="st">[$Wm^{-2}/dec$</span><span class="sc">\\</span><span class="st">]&quot;</span>)) <span class="sc">+</span></span>
<span id="cb540-64"><a href="7.4-ggplot.html#cb540-64" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb540-65"><a href="7.4-ggplot.html#cb540-65" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">&quot;Seasons&quot;</span>) ) <span class="sc">+</span> <span class="co"># change legend title</span></span>
<span id="cb540-66"><a href="7.4-ggplot.html#cb540-66" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">face=</span><span class="st">&quot;bold&quot;</span>),</span>
<span id="cb540-67"><a href="7.4-ggplot.html#cb540-67" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">face=</span><span class="st">&quot;bold&quot;</span>, <span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb540-68"><a href="7.4-ggplot.html#cb540-68" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">face=</span><span class="st">&quot;bold&quot;</span>),</span>
<span id="cb540-69"><a href="7.4-ggplot.html#cb540-69" tabindex="-1"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb540-70"><a href="7.4-ggplot.html#cb540-70" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb540-71"><a href="7.4-ggplot.html#cb540-71" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">face=</span><span class="st">&quot;bold&quot;</span>),</span>
<span id="cb540-72"><a href="7.4-ggplot.html#cb540-72" tabindex="-1"></a>          <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>)</span>
<span id="cb540-73"><a href="7.4-ggplot.html#cb540-73" tabindex="-1"></a>          )</span>
<span id="cb540-74"><a href="7.4-ggplot.html#cb540-74" tabindex="-1"></a>p_box      </span></code></pre></div>
</div>
<div id="guides-together-with-guide_legend" class="section level3 hasAnchor" number="7.4.6">
<h3><span class="header-section-number">7.4.6</span> <code>guides()</code>, together with <code>guide_legend()</code><a href="7.4-ggplot.html#guides-together-with-guide_legend" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://ggplot2-book.org/guides.html#sub-layers-legends" class="uri">https://ggplot2-book.org/guides.html#sub-layers-legends</a></p>
<p>Guides for each scale can be set <strong>scale-by-scale</strong> with the <code>guide</code> argument in <code>scale_*_manual()</code>, or <strong>en masse</strong> with <code>guides(...)</code>.</p>
<ul>
<li><code>...</code> List of scale name-guide pairs. The guide can either be
<ul>
<li>a string (i.e. “colorbar” or “legend”), or</li>
<li>a call to a guide function (i.e. <code>guide_colourbar()</code> or<span style="color:#008B45"> <strong><code>guide_legend()</code> </strong></span>) specifying additional arguments.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="7.4-ggplot.html#cb541-1" tabindex="-1"></a><span class="co"># ggplot object</span></span>
<span id="cb541-2"><a href="7.4-ggplot.html#cb541-2" tabindex="-1"></a></span>
<span id="cb541-3"><a href="7.4-ggplot.html#cb541-3" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">y =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">p =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">q =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),</span>
<span id="cb541-4"><a href="7.4-ggplot.html#cb541-4" tabindex="-1"></a> <span class="at">r =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>))</span>
<span id="cb541-5"><a href="7.4-ggplot.html#cb541-5" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(x, y, <span class="at">colour =</span> p, <span class="at">size =</span> q, <span class="at">shape =</span> r)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb541-6"><a href="7.4-ggplot.html#cb541-6" tabindex="-1"></a></span>
<span id="cb541-7"><a href="7.4-ggplot.html#cb541-7" tabindex="-1"></a><span class="co"># without guide specification</span></span>
<span id="cb541-8"><a href="7.4-ggplot.html#cb541-8" tabindex="-1"></a>p</span>
<span id="cb541-9"><a href="7.4-ggplot.html#cb541-9" tabindex="-1"></a></span>
<span id="cb541-10"><a href="7.4-ggplot.html#cb541-10" tabindex="-1"></a><span class="co"># Show colorbar guide for colour.</span></span>
<span id="cb541-11"><a href="7.4-ggplot.html#cb541-11" tabindex="-1"></a><span class="co"># All these examples below have a same effect.</span></span>
<span id="cb541-12"><a href="7.4-ggplot.html#cb541-12" tabindex="-1"></a></span>
<span id="cb541-13"><a href="7.4-ggplot.html#cb541-13" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">colour =</span> <span class="st">&quot;colorbar&quot;</span>, <span class="at">size =</span> <span class="st">&quot;legend&quot;</span>, <span class="at">shape =</span> <span class="st">&quot;legend&quot;</span>)</span>
<span id="cb541-14"><a href="7.4-ggplot.html#cb541-14" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_colorbar</span>(), <span class="at">size =</span> <span class="fu">guide_legend</span>(),</span>
<span id="cb541-15"><a href="7.4-ggplot.html#cb541-15" tabindex="-1"></a>  <span class="at">shape =</span> <span class="fu">guide_legend</span>())</span>
<span id="cb541-16"><a href="7.4-ggplot.html#cb541-16" tabindex="-1"></a>p <span class="sc">+</span></span>
<span id="cb541-17"><a href="7.4-ggplot.html#cb541-17" tabindex="-1"></a> <span class="fu">scale_colour_continuous</span>(<span class="at">guide =</span> <span class="st">&quot;colorbar&quot;</span>) <span class="sc">+</span></span>
<span id="cb541-18"><a href="7.4-ggplot.html#cb541-18" tabindex="-1"></a> <span class="fu">scale_size_discrete</span>(<span class="at">guide =</span> <span class="st">&quot;legend&quot;</span>) <span class="sc">+</span></span>
<span id="cb541-19"><a href="7.4-ggplot.html#cb541-19" tabindex="-1"></a> <span class="fu">scale_shape</span>(<span class="at">guide =</span> <span class="st">&quot;legend&quot;</span>)</span>
<span id="cb541-20"><a href="7.4-ggplot.html#cb541-20" tabindex="-1"></a></span>
<span id="cb541-21"><a href="7.4-ggplot.html#cb541-21" tabindex="-1"></a> <span class="co"># Remove some guides</span></span>
<span id="cb541-22"><a href="7.4-ggplot.html#cb541-22" tabindex="-1"></a> p <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">colour =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb541-23"><a href="7.4-ggplot.html#cb541-23" tabindex="-1"></a> p <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">colour =</span> <span class="st">&quot;colorbar&quot;</span>, <span class="at">size =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb541-24"><a href="7.4-ggplot.html#cb541-24" tabindex="-1"></a></span>
<span id="cb541-25"><a href="7.4-ggplot.html#cb541-25" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb541-26"><a href="7.4-ggplot.html#cb541-26" tabindex="-1"></a><span class="co"># Guides are `integrated` where possible</span></span>
<span id="cb541-27"><a href="7.4-ggplot.html#cb541-27" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb541-28"><a href="7.4-ggplot.html#cb541-28" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="st">&quot;title&quot;</span>), <span class="at">size =</span> <span class="fu">guide_legend</span>(<span class="st">&quot;title&quot;</span>),</span>
<span id="cb541-29"><a href="7.4-ggplot.html#cb541-29" tabindex="-1"></a>  <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="st">&quot;title&quot;</span>))</span>
<span id="cb541-30"><a href="7.4-ggplot.html#cb541-30" tabindex="-1"></a></span>
<span id="cb541-31"><a href="7.4-ggplot.html#cb541-31" tabindex="-1"></a><span class="co"># same as (more concise)</span></span>
<span id="cb541-32"><a href="7.4-ggplot.html#cb541-32" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">guide_legend</span>(<span class="st">&quot;title&quot;</span>)</span>
<span id="cb541-33"><a href="7.4-ggplot.html#cb541-33" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">colour =</span> g, <span class="at">size =</span> g, <span class="at">shape =</span> g)</span>
<span id="cb541-34"><a href="7.4-ggplot.html#cb541-34" tabindex="-1"></a></span>
<span id="cb541-35"><a href="7.4-ggplot.html#cb541-35" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb541-36"><a href="7.4-ggplot.html#cb541-36" tabindex="-1"></a></span>
<span id="cb541-37"><a href="7.4-ggplot.html#cb541-37" tabindex="-1"></a><span class="co"># Set order for multiple guides/legends #</span></span>
<span id="cb541-38"><a href="7.4-ggplot.html#cb541-38" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, cty)) <span class="sc">+</span></span>
<span id="cb541-39"><a href="7.4-ggplot.html#cb541-39" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> hwy, <span class="at">colour =</span> cyl, <span class="at">shape =</span> drv)) <span class="sc">+</span></span>
<span id="cb541-40"><a href="7.4-ggplot.html#cb541-40" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb541-41"><a href="7.4-ggplot.html#cb541-41" tabindex="-1"></a>   <span class="at">colour =</span> <span class="fu">guide_colourbar</span>(<span class="at">order =</span> <span class="dv">1</span>),</span>
<span id="cb541-42"><a href="7.4-ggplot.html#cb541-42" tabindex="-1"></a>   <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">order =</span> <span class="dv">2</span>),</span>
<span id="cb541-43"><a href="7.4-ggplot.html#cb541-43" tabindex="-1"></a>   <span class="at">size =</span> <span class="fu">guide_legend</span>(<span class="at">order =</span> <span class="dv">3</span>)</span>
<span id="cb541-44"><a href="7.4-ggplot.html#cb541-44" tabindex="-1"></a> )</span></code></pre></div>
<p><code>guide_legend(title = waiver(), label = TRUE, keywidth = NULL, keyheight = NULL, override.aes = list(), nrow = NULL, ncol = NULL, byrow = FALSE, reverse = FALSE,order = 0, ...)</code> Legend type guide shows key (i.e., geoms) mapped onto values. Legend guides for various scales are integrated if possible.</p>
<ul>
<li><code>title</code> A character string or expression indicating a title of guide.
<ul>
<li><code>NULL</code>, the title is not shown.</li>
<li>By default (<code>waiver()</code>), the name of the scale object or the name specified in <code>labs()</code> is used for the title.</li>
</ul></li>
<li><code>override.aes</code> Takes a <code>list</code> of aesthetic parameters that will <span style="color:#008B45"><em>override</em></span> the default legend appearance.</li>
<li><code>nrow</code>, <code>ncol</code> The desired <span style="color:#008B45">number of rows/columns of legends</span>.</li>
<li><code>reverse</code> logical. If <code>TRUE</code> the order of legends is reversed.</li>
<li><span style="color:#008B45&#39;"><strong><code>order</code> </strong></span> positive integer less than 99 that <span style="color:#008B45">specifies the order of this guide</span> among multiple guides. This controls the order in which multiple guides are displayed, <strong>not</strong> the contents of the guide itself.</li>
</ul>
</div>
<div id="template-for-multi-series" class="section level3 hasAnchor" number="7.4.7">
<h3><span class="header-section-number">7.4.7</span> Template for multi-series<a href="7.4-ggplot.html#template-for-multi-series" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span style="color:#008B45&#39;">Multiple groups aesthetics</span>, e.g., <code>color</code>, <code>size</code>, <code>linetype</code>, …, if you want an integrated legend, need to set the same title for the aesthetics.</p>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="7.4-ggplot.html#cb542-1" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">guide_legend</span>(<span class="st">&quot;title&quot;</span>, <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>) <span class="co"># define legend aes</span></span>
<span id="cb542-2"><a href="7.4-ggplot.html#cb542-2" tabindex="-1"></a><span class="co"># colors</span></span>
<span id="cb542-3"><a href="7.4-ggplot.html#cb542-3" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;values&quot;</span><span class="ot">=</span><span class="st">&quot;blue&quot;</span>, <span class="st">&quot;values_ma&quot;</span><span class="ot">=</span><span class="st">&quot;blue&quot;</span>, <span class="st">&quot;lm1&quot;</span><span class="ot">=</span><span class="st">&quot;red&quot;</span>, </span>
<span id="cb542-4"><a href="7.4-ggplot.html#cb542-4" tabindex="-1"></a>          <span class="st">&quot;values2&quot;</span><span class="ot">=</span><span class="st">&quot;black&quot;</span>, <span class="st">&quot;values_ma2&quot;</span><span class="ot">=</span><span class="st">&quot;black&quot;</span>, <span class="st">&quot;lm2&quot;</span><span class="ot">=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb542-5"><a href="7.4-ggplot.html#cb542-5" tabindex="-1"></a><span class="co"># if you don&#39;t want to repeat the breaks, you may use `setNames`</span></span>
<span id="cb542-6"><a href="7.4-ggplot.html#cb542-6" tabindex="-1"></a><span class="co"># cols &lt;- setNames(ob = c(&quot;blue&quot;, &quot;blue&quot;, &quot;red&quot;, &quot;black&quot;, &quot;black&quot;, &quot;red&quot;),</span></span>
<span id="cb542-7"><a href="7.4-ggplot.html#cb542-7" tabindex="-1"></a><span class="co">#                        nm = c(&quot;values&quot;, &quot;values_ma&quot;, &quot;lm1&quot;, &quot;values2&quot;, &quot;values_ma2&quot;, &quot;lm2&quot;))</span></span>
<span id="cb542-8"><a href="7.4-ggplot.html#cb542-8" tabindex="-1"></a></span>
<span id="cb542-9"><a href="7.4-ggplot.html#cb542-9" tabindex="-1"></a><span class="co"># line widths</span></span>
<span id="cb542-10"><a href="7.4-ggplot.html#cb542-10" tabindex="-1"></a>sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;values&quot;</span><span class="ot">=</span><span class="fl">0.3</span>, <span class="st">&quot;values_ma&quot;</span><span class="ot">=</span><span class="fl">0.7</span>, <span class="st">&quot;lm1&quot;</span><span class="ot">=</span><span class="fl">0.7</span>,</span>
<span id="cb542-11"><a href="7.4-ggplot.html#cb542-11" tabindex="-1"></a>           <span class="st">&quot;values2&quot;</span><span class="ot">=</span><span class="fl">0.3</span>, <span class="st">&quot;values_ma2&quot;</span><span class="ot">=</span><span class="fl">0.7</span>, <span class="st">&quot;lm2&quot;</span><span class="ot">=</span><span class="fl">0.7</span>)</span>
<span id="cb542-12"><a href="7.4-ggplot.html#cb542-12" tabindex="-1"></a><span class="co"># linetypes</span></span>
<span id="cb542-13"><a href="7.4-ggplot.html#cb542-13" tabindex="-1"></a>lines <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;values&quot;</span><span class="ot">=</span><span class="st">&quot;dashed&quot;</span>, <span class="st">&quot;values_ma&quot;</span><span class="ot">=</span><span class="st">&quot;solid&quot;</span>, <span class="st">&quot;lm1&quot;</span><span class="ot">=</span><span class="st">&quot;solid&quot;</span>,</span>
<span id="cb542-14"><a href="7.4-ggplot.html#cb542-14" tabindex="-1"></a>           <span class="st">&quot;values2&quot;</span><span class="ot">=</span><span class="st">&quot;dashed&quot;</span>, <span class="st">&quot;values_ma2&quot;</span><span class="ot">=</span><span class="st">&quot;solid&quot;</span>, <span class="st">&quot;lm2&quot;</span><span class="ot">=</span><span class="st">&quot;solid&quot;</span>)</span>
<span id="cb542-15"><a href="7.4-ggplot.html#cb542-15" tabindex="-1"></a><span class="co"># breaks:</span></span>
<span id="cb542-16"><a href="7.4-ggplot.html#cb542-16" tabindex="-1"></a><span class="co">#           — if omit a series in `breaks`, the series will be droped; </span></span>
<span id="cb542-17"><a href="7.4-ggplot.html#cb542-17" tabindex="-1"></a><span class="co">#           — rearrange legend order; </span></span>
<span id="cb542-18"><a href="7.4-ggplot.html#cb542-18" tabindex="-1"></a>breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;values&quot;</span>, <span class="st">&quot;values_ma&quot;</span>, <span class="st">&quot;lm1&quot;</span>, </span>
<span id="cb542-19"><a href="7.4-ggplot.html#cb542-19" tabindex="-1"></a>            <span class="st">&quot;values2&quot;</span>, <span class="st">&quot;values_ma2&quot;</span>, <span class="st">&quot;lm2&quot;</span>)</span>
<span id="cb542-20"><a href="7.4-ggplot.html#cb542-20" tabindex="-1"></a><span class="co"># labels, must match the length of `breaks`</span></span>
<span id="cb542-21"><a href="7.4-ggplot.html#cb542-21" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;raw&quot;</span>, <span class="st">&quot;Gaussian MA&quot;</span>, </span>
<span id="cb542-22"><a href="7.4-ggplot.html#cb542-22" tabindex="-1"></a>            <span class="fu">unname</span>(<span class="fu">TeX</span>( <span class="fu">sprintf</span>(<span class="st">&quot;Reg Line </span><span class="sc">\\</span><span class="st">textbf{1961-2019}, </span><span class="sc">\\</span><span class="st">[%.2f, %.2f, %.2f</span><span class="sc">\\</span><span class="st">] </span><span class="sc">\\</span><span class="st">[$Wm^{-2}/dec$</span><span class="sc">\\</span><span class="st">]&quot;</span>, decadal_trend[<span class="st">&quot;beta&quot;</span>], decadal_trend[<span class="st">&quot;lower bound&quot;</span>], decadal_trend[<span class="st">&quot;upper bound&quot;</span>]) ) ),</span>
<span id="cb542-23"><a href="7.4-ggplot.html#cb542-23" tabindex="-1"></a>            <span class="st">&quot;raw2&quot;</span>, <span class="st">&quot;Gaussian MA2&quot;</span>, </span>
<span id="cb542-24"><a href="7.4-ggplot.html#cb542-24" tabindex="-1"></a>            <span class="fu">unname</span>(<span class="fu">TeX</span>( <span class="fu">sprintf</span>(<span class="st">&quot;Reg Line2 </span><span class="sc">\\</span><span class="st">textbf{%s-2019}, </span><span class="sc">\\</span><span class="st">[%.2f, %.2f, %.2f</span><span class="sc">\\</span><span class="st">] </span><span class="sc">\\</span><span class="st">[$Wm^{-2}/dec$</span><span class="sc">\\</span><span class="st">]&quot;</span>, bk_point<span class="sc">+</span><span class="dv">1</span>, decadal_trend_2[<span class="st">&quot;beta&quot;</span>], decadal_trend_2[<span class="st">&quot;lower bound&quot;</span>], decadal_trend_2[<span class="st">&quot;upper bound&quot;</span>]) ) )</span>
<span id="cb542-25"><a href="7.4-ggplot.html#cb542-25" tabindex="-1"></a>)</span>
<span id="cb542-26"><a href="7.4-ggplot.html#cb542-26" tabindex="-1"></a></span>
<span id="cb542-27"><a href="7.4-ggplot.html#cb542-27" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> cols, <span class="at">breaks=</span>breaks, <span class="at">labels =</span> labels) <span class="sc">+</span></span>
<span id="cb542-28"><a href="7.4-ggplot.html#cb542-28" tabindex="-1"></a>    <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span>lines, <span class="at">breaks=</span>breaks, <span class="at">labels =</span> labels) <span class="sc">+</span></span>
<span id="cb542-29"><a href="7.4-ggplot.html#cb542-29" tabindex="-1"></a>    <span class="fu">scale_size_manual</span>(<span class="at">values=</span>sizes, <span class="at">breaks=</span>breaks, <span class="at">labels =</span> labels) <span class="sc">+</span></span>
<span id="cb542-30"><a href="7.4-ggplot.html#cb542-30" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb542-31"><a href="7.4-ggplot.html#cb542-31" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">colour=</span>g, <span class="at">linetype=</span>g, <span class="at">size=</span>g <span class="co"># specify all aes for legend at once</span></span>
<span id="cb542-32"><a href="7.4-ggplot.html#cb542-32" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb542-33"><a href="7.4-ggplot.html#cb542-33" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="co"># title size</span></span>
<span id="cb542-34"><a href="7.4-ggplot.html#cb542-34" tabindex="-1"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(), <span class="co"># axis lable</span></span>
<span id="cb542-35"><a href="7.4-ggplot.html#cb542-35" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="co"># remove legend title</span></span>
<span id="cb542-36"><a href="7.4-ggplot.html#cb542-36" tabindex="-1"></a>          <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>), <span class="co"># legend scale size</span></span>
<span id="cb542-37"><a href="7.4-ggplot.html#cb542-37" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.37</span>, <span class="fl">0.9</span>), </span>
<span id="cb542-38"><a href="7.4-ggplot.html#cb542-38" tabindex="-1"></a>          <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb542-39"><a href="7.4-ggplot.html#cb542-39" tabindex="-1"></a>          <span class="at">legend.spacing.y =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">&#39;mm&#39;</span>), <span class="co"># spacing between legend title and legends;</span></span>
<span id="cb542-40"><a href="7.4-ggplot.html#cb542-40" tabindex="-1"></a>          <span class="at">legend.text.align =</span> <span class="dv">0</span>, <span class="co"># legend key align to the left</span></span>
<span id="cb542-41"><a href="7.4-ggplot.html#cb542-41" tabindex="-1"></a>          <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>,<span class="st">&quot;line&quot;</span>), <span class="co"># spacing between legend items;</span></span>
<span id="cb542-42"><a href="7.4-ggplot.html#cb542-42" tabindex="-1"></a>          <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="at">t=</span><span class="dv">0</span>, <span class="at">b=</span><span class="dv">0</span>, <span class="at">unit=</span><span class="st">&quot;mm&quot;</span>) <span class="co"># margins around legend box</span></span>
<span id="cb542-43"><a href="7.4-ggplot.html#cb542-43" tabindex="-1"></a>    )</span></code></pre></div>
<ul>
<li><code>legend.position</code> Can be text placement. Five possible values: <code>“left”</code>, <code>“top”</code>, <code>“right”</code>, <code>“bottom”</code>, or <code>"none"</code> (disable legend).
<ul>
<li>The argument <code>legend.position</code> can be also a numeric vector <code>c(x,y)</code>. In this case it is possible to position the legend inside the plotting area. <code>x</code> and <code>y</code> are the coordinates of the legend box. Their values should be between <code>0</code> and <code>1</code>. <code>c(0,0)</code> corresponds to the “bottom left” and <code>c(1,1)</code> corresponds to the “top right” position.</li>
</ul></li>
<li><code>legend.key.height</code> the height of the legend key; reduce or add vertical spacing between legend items.</li>
<li><code>legend.key.width</code> the width of the legend key;</li>
<li><code>legend.text.align = 0</code> <span style="color:#008B45">align legend keys/text to the left;</span></li>
<li><code>legend.box.background = element_rect(colour = "black", size=1)</code> add box to legend</li>
<li><code>legend.direction</code> layout of items in legends (“horizontal” or “vertical”)</li>
<li><code>legend.box</code> arrangement of multiple legends (“horizontal” or “vertical”)</li>
</ul>
<p><code>guides()</code> re-define guides, an example for <code>override.aes</code>; could also be used to remove some legends by specifying e.g., <code>color="none"</code>.</p>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="7.4-ggplot.html#cb543-1" tabindex="-1"></a><span class="fu">guides</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>,</span>
<span id="cb543-2"><a href="7.4-ggplot.html#cb543-2" tabindex="-1"></a>       <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span></span>
<span id="cb543-3"><a href="7.4-ggplot.html#cb543-3" tabindex="-1"></a>                      <span class="fu">list</span>(<span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;converted&quot;</span><span class="ot">=</span><span class="st">&quot;#00BFC4&quot;</span>, <span class="st">&quot;reported&quot;</span><span class="ot">=</span><span class="st">&quot;#FF6666&quot;</span>, <span class="at">obs_col=</span><span class="cn">NA</span>),</span>
<span id="cb543-4"><a href="7.4-ggplot.html#cb543-4" tabindex="-1"></a>                           <span class="at">color =</span> <span class="fu">c</span>(<span class="st">&quot;converted&quot;</span><span class="ot">=</span><span class="st">&quot;#00BFC4&quot;</span>, <span class="st">&quot;reported&quot;</span><span class="ot">=</span><span class="st">&quot;#FF6666&quot;</span>, <span class="at">obs_col=</span><span class="st">&quot;#010912&quot;</span>)</span>
<span id="cb543-5"><a href="7.4-ggplot.html#cb543-5" tabindex="-1"></a>                           )</span>
<span id="cb543-6"><a href="7.4-ggplot.html#cb543-6" tabindex="-1"></a>                      )</span>
<span id="cb543-7"><a href="7.4-ggplot.html#cb543-7" tabindex="-1"></a>         )</span>
<span id="cb543-8"><a href="7.4-ggplot.html#cb543-8" tabindex="-1"></a></span>
<span id="cb543-9"><a href="7.4-ggplot.html#cb543-9" tabindex="-1"></a><span class="fu">guides</span>(<span class="at">linetype =</span> <span class="cn">FALSE</span>,</span>
<span id="cb543-10"><a href="7.4-ggplot.html#cb543-10" tabindex="-1"></a>       <span class="at">size =</span> <span class="cn">FALSE</span>,</span>
<span id="cb543-11"><a href="7.4-ggplot.html#cb543-11" tabindex="-1"></a>       <span class="at">color =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb543-12"><a href="7.4-ggplot.html#cb543-12" tabindex="-1"></a>           <span class="at">override.aes =</span> <span class="fu">list</span>(</span>
<span id="cb543-13"><a href="7.4-ggplot.html#cb543-13" tabindex="-1"></a>               <span class="at">linetype =</span> lines,</span>
<span id="cb543-14"><a href="7.4-ggplot.html#cb543-14" tabindex="-1"></a>               <span class="at">color =</span> cols,</span>
<span id="cb543-15"><a href="7.4-ggplot.html#cb543-15" tabindex="-1"></a>               <span class="at">size =</span> sizes </span>
<span id="cb543-16"><a href="7.4-ggplot.html#cb543-16" tabindex="-1"></a>                 ),</span>
<span id="cb543-17"><a href="7.4-ggplot.html#cb543-17" tabindex="-1"></a>           <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb543-18"><a href="7.4-ggplot.html#cb543-18" tabindex="-1"></a>           <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb543-19"><a href="7.4-ggplot.html#cb543-19" tabindex="-1"></a>           )</span>
<span id="cb543-20"><a href="7.4-ggplot.html#cb543-20" tabindex="-1"></a>      )</span></code></pre></div>
<p><strong>Change legend title</strong></p>
<p>Specify a new legend title for the <code>color</code> aesthetic:</p>
<ul>
<li><code>labs(color="My new title")</code></li>
<li><code>guides(color=guide_legend("My new title"))</code></li>
</ul>
<p><strong>Putting two different legends in two columns</strong></p>
<p><code>theme(legend.box = "horizontal")</code></p>
<p>Add legend to <code>geom_vline</code></p>
<p>Need to specify <code>color</code> inside <code>aes</code>, then use <code>scale_color_manual</code> to specify legends.</p>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="7.4-ggplot.html#cb544-1" tabindex="-1"></a><span class="fu">ggplot</span>(end_climate, <span class="fu">aes</span>(<span class="at">x=</span>end.pre)) <span class="sc">+</span></span>
<span id="cb544-2"><a href="7.4-ggplot.html#cb544-2" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">binwidth=</span><span class="fl">0.1</span>, <span class="at">fill=</span><span class="st">&quot;#BDBCBC&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb544-3"><a href="7.4-ggplot.html#cb544-3" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept=</span><span class="fl">1.734513</span>, <span class="at">color=</span><span class="st">&quot;Burke&quot;</span>), <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb544-4"><a href="7.4-ggplot.html#cb544-4" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;Burke&quot;</span><span class="ot">=</span><span class="st">&quot;red&quot;</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Burke&quot;</span><span class="ot">=</span><span class="st">&quot;Burke&#39;s fixed optimum&quot;</span>)) <span class="sc">+</span></span>
<span id="cb544-5"><a href="7.4-ggplot.html#cb544-5" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Precipitation in 2019 [Meters]&quot;</span>) <span class="sc">+</span></span>
<span id="cb544-6"><a href="7.4-ggplot.html#cb544-6" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.9</span>),</span>
<span id="cb544-7"><a href="7.4-ggplot.html#cb544-7" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb544-8"><a href="7.4-ggplot.html#cb544-8" tabindex="-1"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(), )</span></code></pre></div>
<p><img src="https://drive.google.com/thumbnail?id=1msAI5IfGRrWbpPK-63WIBPQxNT4qmVEo&sz=w1000" alt="histogram" style="display: block; margin-right: auto; margin-left: auto; zoom:60%;" /></p>
<p><strong>legend alignment</strong> (irregular legends)</p>
<p>split legends into multiple ragged rows/columns (with different length) as you desire</p>
<p><a href="https://stackoverflow.com/questions/27803710/ggplot2-divide-legend-into-two-columns-each-with-its-own-title" class="uri">https://stackoverflow.com/questions/27803710/ggplot2-divide-legend-into-two-columns-each-with-its-own-title</a></p>
<p>Key idea:</p>
<ol style="list-style-type: decimal">
<li>create a dummy factor level and setting its colour to <strong>white</strong> in the legend, so that it can’t be seen.</li>
<li>so now we have regular levels. Then, we use <code>scale_fill_manual</code> to set the color of this <strong>blank level</strong> to “white”. <span style="color:red"><strong><code>drop=FALSE</code></strong></span> forces <code>ggplot</code> to <span style="color:red"><strong>keep the blank level in the legend</strong></span>.</li>
<li>Remember to<span style="color:red"> <strong><code>factor</code></strong></span> the category column.</li>
</ol>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="7.4-ggplot.html#cb545-1" tabindex="-1"></a><span class="do">## `factor` the category column, and specify `drop=FALSE`</span></span>
<span id="cb545-2"><a href="7.4-ggplot.html#cb545-2" tabindex="-1"></a>diamonds<span class="sc">$</span>cut <span class="ot">=</span> <span class="fu">factor</span>(diamonds<span class="sc">$</span>cut, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Fair&quot;</span>,<span class="st">&quot;Good&quot;</span>,<span class="st">&quot; &quot;</span>,<span class="st">&quot;Very Good&quot;</span>,</span>
<span id="cb545-3"><a href="7.4-ggplot.html#cb545-3" tabindex="-1"></a>                                             <span class="st">&quot;Premium&quot;</span>,<span class="st">&quot;Ideal&quot;</span>))</span>
<span id="cb545-4"><a href="7.4-ggplot.html#cb545-4" tabindex="-1"></a></span>
<span id="cb545-5"><a href="7.4-ggplot.html#cb545-5" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(color, <span class="at">fill=</span>cut)) <span class="sc">+</span> <span class="fu">geom_bar</span>() <span class="sc">+</span> </span>
<span id="cb545-6"><a href="7.4-ggplot.html#cb545-6" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="fu">hcl</span>(<span class="fu">seq</span>(<span class="dv">15</span>,<span class="dv">325</span>,<span class="at">length.out=</span><span class="dv">5</span>), <span class="dv">100</span>, <span class="dv">65</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], </span>
<span id="cb545-7"><a href="7.4-ggplot.html#cb545-7" tabindex="-1"></a>                             <span class="st">&quot;white&quot;</span>,</span>
<span id="cb545-8"><a href="7.4-ggplot.html#cb545-8" tabindex="-1"></a>                             <span class="fu">hcl</span>(<span class="fu">seq</span>(<span class="dv">15</span>,<span class="dv">325</span>,<span class="at">length.out=</span><span class="dv">5</span>), <span class="dv">100</span>, <span class="dv">65</span>)[<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>]),</span>
<span id="cb545-9"><a href="7.4-ggplot.html#cb545-9" tabindex="-1"></a>                    <span class="at">drop=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb545-10"><a href="7.4-ggplot.html#cb545-10" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">ncol=</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb545-11"><a href="7.4-ggplot.html#cb545-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p>Retrieve <strong>environment variable</strong></p>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="7.4-ggplot.html#cb546-1" tabindex="-1"></a><span class="fu">Sys.getenv</span>(<span class="st">&#39;PLOTLY_MATHJAX_PATH&#39;</span>)</span>
<span id="cb546-2"><a href="7.4-ggplot.html#cb546-2" tabindex="-1"></a><span class="co"># set an environment variable</span></span>
<span id="cb546-3"><a href="7.4-ggplot.html#cb546-3" tabindex="-1"></a><span class="fu">Sys.setenv</span>(<span class="st">&#39;PLOTLY_MATHJAX_PATH&#39;</span> <span class="ot">=</span> <span class="st">&#39;/Users/Menghan/Documents/R/MathJax&#39;</span>)</span></code></pre></div>
<p>Check global setting/options</p>
<p><code>options(...)</code> set options, using <code>name = value</code>.</p>
<p><code>getOption(x, default=NULL)</code> get option values.</p>
<ul>
<li><code>default</code> if the specified option is not set in the options list, this value is returned. This facilitates retrieving an option and checking whether it is set and setting it separately if not.</li>
</ul>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="7.4-ggplot.html#cb547-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">options</span>(<span class="st">&quot;device&quot;</span>)</span>
<span id="cb547-2"><a href="7.4-ggplot.html#cb547-2" tabindex="-1"></a><span class="sc">$</span>device</span>
<span id="cb547-3"><a href="7.4-ggplot.html#cb547-3" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;RStudioGD&quot;</span></span></code></pre></div>
<p>Check package version</p>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="7.4-ggplot.html#cb548-1" tabindex="-1"></a><span class="fu">packageVersion</span>(<span class="st">&quot;snow&quot;</span>)</span></code></pre></div>
<p><strong>Length Unit</strong></p>
<p>The relation between the absolute units is as follows: 1in = 2.54cm = 25.4mm = 72pt = 6pc</p>
<p><strong>Latex symbol in legend labels</strong></p>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="7.4-ggplot.html#cb549-1" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>() <span class="co"># specify col vector here</span></span>
<span id="cb549-2"><a href="7.4-ggplot.html#cb549-2" tabindex="-1"></a>sizes <span class="ot">&lt;-</span> <span class="fu">c</span>() <span class="co"># specify linewidth </span></span>
<span id="cb549-3"><a href="7.4-ggplot.html#cb549-3" tabindex="-1"></a>lines <span class="ot">&lt;-</span> <span class="fu">c</span>() <span class="co"># linetype</span></span>
<span id="cb549-4"><a href="7.4-ggplot.html#cb549-4" tabindex="-1"></a>breaks <span class="ot">&lt;-</span> <span class="fu">c</span>() <span class="co"># group breaks, set legend order;</span></span>
<span id="cb549-5"><a href="7.4-ggplot.html#cb549-5" tabindex="-1"></a></span>
<span id="cb549-6"><a href="7.4-ggplot.html#cb549-6" tabindex="-1"></a><span class="do">## note that the use of `unname()` is necessary</span></span>
<span id="cb549-7"><a href="7.4-ggplot.html#cb549-7" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">unname</span>(latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="fu">c</span>(<span class="st">&quot;$A_{t-k}^h$&quot;</span>, <span class="st">&quot;$B_{t-k}^h$&quot;</span>)))</span>
<span id="cb549-8"><a href="7.4-ggplot.html#cb549-8" tabindex="-1"></a></span>
<span id="cb549-9"><a href="7.4-ggplot.html#cb549-9" tabindex="-1"></a><span class="fu">scale_colour_manual</span>(<span class="at">values =</span> cols, <span class="at">breaks=</span>breaks, <span class="at">labels =</span> labels) <span class="sc">+</span></span>
<span id="cb549-10"><a href="7.4-ggplot.html#cb549-10" tabindex="-1"></a>    <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span>lines, <span class="at">breaks=</span>breaks, <span class="at">labels =</span> labels) <span class="sc">+</span></span>
<span id="cb549-11"><a href="7.4-ggplot.html#cb549-11" tabindex="-1"></a>    <span class="fu">scale_size_manual</span>(<span class="at">values=</span>sizes, <span class="at">breaks=</span>breaks, <span class="at">labels =</span> labels) </span></code></pre></div>
</div>
<div id="grid.gedit" class="section level3 hasAnchor" number="7.4.8">
<h3><span class="header-section-number">7.4.8</span> <code>grid.gedit()</code><a href="7.4-ggplot.html#grid.gedit" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://bookdown.org/rdpeng/RProgDA/the-grid-package.html#grobs" class="uri">https://bookdown.org/rdpeng/RProgDA/the-grid-package.html#grobs</a></p>
<p><a href="https://stackoverflow.com/questions/15059093/ggplot2-adjust-the-symbol-size-in-legends" class="uri">https://stackoverflow.com/questions/15059093/ggplot2-adjust-the-symbol-size-in-legends</a></p>
<p><code>grid.gedit(..., grep = TRUE, global = TRUE)</code> Changes the value of one of the slots of a grob and redraws the grob.</p>
<ul>
<li><code>...</code> Zero or more named arguments specifying new slot values.</li>
</ul>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="7.4-ggplot.html#cb550-1" tabindex="-1"></a><span class="co"># To get the names of all the grobs in the ggplot</span></span>
<span id="cb550-2"><a href="7.4-ggplot.html#cb550-2" tabindex="-1"></a><span class="fu">grid.ls</span>(<span class="fu">grid.force</span>())    </span>
<span id="cb550-3"><a href="7.4-ggplot.html#cb550-3" tabindex="-1"></a></span>
<span id="cb550-4"><a href="7.4-ggplot.html#cb550-4" tabindex="-1"></a><span class="co"># The edit - to set the size of the point in the legend to 4 mm</span></span>
<span id="cb550-5"><a href="7.4-ggplot.html#cb550-5" tabindex="-1"></a><span class="fu">grid.gedit</span>(<span class="st">&quot;key-[-0-9]-1-1&quot;</span>, <span class="at">size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">&quot;mm&quot;</span>))    </span></code></pre></div>
<p><strong>Transparency in Rstudio</strong></p>
<p><a href="https://tinyheero.github.io/2015/09/15/semi-transparency-r.html" class="uri">https://tinyheero.github.io/2015/09/15/semi-transparency-r.html</a></p>
<p>Error Message:</p>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="7.4-ggplot.html#cb551-1" tabindex="-1"></a>Warning message<span class="sc">:</span></span>
<span id="cb551-2"><a href="7.4-ggplot.html#cb551-2" tabindex="-1"></a>In <span class="fu">grid.Call.graphics</span>(L_polygon, x<span class="sc">$</span>x, x<span class="sc">$</span>y, index) <span class="sc">:</span></span>
<span id="cb551-3"><a href="7.4-ggplot.html#cb551-3" tabindex="-1"></a>  semi<span class="sc">-</span>transparency is not supported on this device<span class="sc">:</span> reported only once per page</span></code></pre></div>
<p>Fix:</p>
<p>I was able to solve this issue by switching over to <u>use the Cairo graphics device</u>. Make sure you first install the <a href="https://cran.r-project.org/web/packages/Cairo/index.html">Cairo R package</a>.</p>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="7.4-ggplot.html#cb552-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;Cairo&quot;</span>)</span></code></pre></div>
<p>Once you have that installed, place the following in your ~/.Rprofile</p>
<div class="sourceCode" id="cb553"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb553-1"><a href="7.4-ggplot.html#cb553-1" tabindex="-1"></a><span class="ex">setHook</span><span class="er">(</span><span class="ex">packageEvent</span><span class="er">(</span><span class="st">&quot;grDevices&quot;</span><span class="ex">,</span> <span class="st">&quot;onLoad&quot;</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb553-2"><a href="7.4-ggplot.html#cb553-2" tabindex="-1"></a><span class="kw">function(</span><span class="ex">...</span><span class="kw">)</span> <span class="ex">grDevices::X11.options</span><span class="er">(</span><span class="va">type</span><span class="op">=</span><span class="st">&#39;cairo&#39;</span><span class="kw">))</span></span>
<span id="cb553-3"><a href="7.4-ggplot.html#cb553-3" tabindex="-1"></a><span class="ex">options</span><span class="er">(</span><span class="va">device</span><span class="op">=</span><span class="st">&#39;x11&#39;</span><span class="kw">)</span> <span class="co"># set default Graphic Device</span></span></code></pre></div>
<p>This makes it so that your default graphics device is set to Cairo whenever you start a new R session. Now open a new R session, and try the same plotting code (from above). You should see a plot with transparency.</p>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="7.4-ggplot.html#cb554-1" tabindex="-1"></a><span class="co"># get default graphic device</span></span>
<span id="cb554-2"><a href="7.4-ggplot.html#cb554-2" tabindex="-1"></a><span class="fu">getOption</span>(<span class="st">&quot;device&quot;</span>)</span></code></pre></div>
<p><strong>What’s a graphic device?</strong></p>
<p>It’s the engine that renders your plot. Common graphics devices are Quartz and X11.</p>
<p>Install package from source file <code>.tar</code></p>
<p><code>install.packages("~/Downloads/greenbrown_2.4.3.tar", repos = NULL, type="source")</code></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="7.3-control-graphics-devices.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="7.5-plot-raster-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "night",
"family": "sans",
"size": 3
},
"edit": {
"link": "https://github.com/my1396/R-Notes/edit/main/0605-ggplot.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub", "https://github.com/my1396/R-Notes/raw/main/0605-ggplot.Rmd"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toc_depth": 3,
"toc_float": true,
"enableEmoji": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
